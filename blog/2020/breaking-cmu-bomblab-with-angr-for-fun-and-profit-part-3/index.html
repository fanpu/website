<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Breaking CMU's Bomblab with Angr for Fun and Profit - Part 3 | Fan Pu  Zeng</title>
    <meta name="author" content="Fan Pu  Zeng">
    <meta name="description" content="We're back now with Part 3 of this series on cracking CMU's Bomblab using Angr!
">
    <meta name="keywords" content="fanpu, fan pu, fanpu zeng, fan pu zeng, zengfanpu, fanpuzeng, fzeng, CMU, cmu, carnegie mellon, cmu courses, school of computer science, scs, machine learning, computer science, ml, theory, courses, course reviews, CS, Jane Street">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Bootstrap Table -->
    <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    
    <!-- Sidebar Table of Contents -->
    <link href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css" rel="stylesheet">
    

    <!-- Styles -->
    
    <link rel="shortcut icon" href="/assets/img/favicon_new.ico">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://fanpu.io/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-3/">
    <!-- Dark Mode -->
    

    <!-- Twitter cards -->
    <meta name="twitter:site" content="@FanPu_Zeng">
    <meta name="twitter:creator" content="@fanpu">
    <meta name="og:title" content="Breaking CMU's Bomblab with Angr for Fun and Profit - Part 3">

    
    <meta name="twitter:card" content="summary_large_image">
    
    <meta name="og:image" content="https://fanpu.io/assets/img/posts/lily_mountain.webp">

    

    
    <meta name="og:description" content="We're back now with Part 3 of this series on cracking CMU's Bomblab using Angr!
">
    

    <!-- end of Twitter cards -->
  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Fan Pu </span>Zeng</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">About</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/courses/">CMU Course Reviews</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cmu-online/">CMU Online</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/summaries/">ML Paper Summaries</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/repositories/">Repositories</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      
        
        <div class="row">
          <!-- sidebar, which will move to the top on a small screen -->
          <div class="col-sm-3">
            <nav id="toc-sidebar" class="sticky-top"></nav>
          </div>
          <!-- main content area -->
          <div class="col-sm-9">
            <!-- _layouts/post.html -->

<div class="post">

  <div style="display:none">
    $$
    \newcommand{\bone}{\mathbf{1}}
    \newcommand{\bbeta}{\mathbf{\beta}}
    \newcommand{\bdelta}{\mathbf{\delta}}
    \newcommand{\bepsilon}{\mathbf{\epsilon}}
    \newcommand{\blambda}{\mathbf{\lambda}}
    \newcommand{\bomega}{\mathbf{\omega}}
    \newcommand{\bpi}{\mathbf{\pi}}
    \newcommand{\bphi}{\mathbf{\phi}}
    \newcommand{\bvphi}{\mathbf{\varphi}}
    \newcommand{\bpsi}{\mathbf{\psi}}
    \newcommand{\bsigma}{\mathbf{\sigma}}
    \newcommand{\btheta}{\mathbf{\theta}}
    \newcommand{\btau}{\mathbf{\tau}}
    \newcommand{\ba}{\mathbf{a}}
    \newcommand{\bb}{\mathbf{b}}
    \newcommand{\bc}{\mathbf{c}}
    \newcommand{\bd}{\mathbf{d}}
    \newcommand{\be}{\mathbf{e}}
    \newcommand{\boldf}{\mathbf{f}}
    \newcommand{\bg}{\mathbf{g}}
    \newcommand{\bh}{\mathbf{h}}
    \newcommand{\bi}{\mathbf{i}}
    \newcommand{\bj}{\mathbf{j}}
    \newcommand{\bk}{\mathbf{k}}
    \newcommand{\bell}{\mathbf{\ell}}
    \newcommand{\bm}{\mathbf{m}}
    \newcommand{\bn}{\mathbf{n}}
    \newcommand{\bo}{\mathbf{o}}
    \newcommand{\bp}{\mathbf{p}}
    \newcommand{\bq}{\mathbf{q}}
    \newcommand{\br}{\mathbf{r}}
    \newcommand{\bs}{\mathbf{s}}
    \newcommand{\bt}{\mathbf{t}}
    \newcommand{\bu}{\mathbf{u}}
    \newcommand{\bv}{\mathbf{v}}
    \newcommand{\bw}{\mathbf{w}}
    \newcommand{\bx}{\mathbf{x}}
    \newcommand{\by}{\mathbf{y}}
    \newcommand{\bz}{\mathbf{z}}
    \newcommand{\bA}{\mathbf{A}}
    \newcommand{\bB}{\mathbf{B}}
    \newcommand{\bC}{\mathbf{C}}
    \newcommand{\bD}{\mathbf{D}}
    \newcommand{\bE}{\mathbf{E}}
    \newcommand{\bF}{\mathbf{F}}
    \newcommand{\bG}{\mathbf{G}}
    \newcommand{\bH}{\mathbf{H}}
    \newcommand{\bI}{\mathbf{I}}
    \newcommand{\bJ}{\mathbf{J}}
    \newcommand{\bK}{\mathbf{K}}
    \newcommand{\bL}{\mathbf{L}}
    \newcommand{\bM}{\mathbf{M}}
    \newcommand{\bN}{\mathbf{N}}
    \newcommand{\bP}{\mathbf{P}}
    \newcommand{\bQ}{\mathbf{Q}}
    \newcommand{\bR}{\mathbf{R}}
    \newcommand{\bS}{\mathbf{S}}
    \newcommand{\bT}{\mathbf{T}}
    \newcommand{\bU}{\mathbf{U}}
    \newcommand{\bV}{\mathbf{V}}
    \newcommand{\bW}{\mathbf{W}}
    \newcommand{\bX}{\mathbf{X}}
    \newcommand{\bY}{\mathbf{Y}}
    \newcommand{\bZ}{\mathbf{Z}}

    \newcommand{\bsa}{\boldsymbol{a}}
    \newcommand{\bsb}{\boldsymbol{b}}
    \newcommand{\bsc}{\boldsymbol{c}}
    \newcommand{\bsd}{\boldsymbol{d}}
    \newcommand{\bse}{\boldsymbol{e}}
    \newcommand{\bsoldf}{\boldsymbol{f}}
    \newcommand{\bsg}{\boldsymbol{g}}
    \newcommand{\bsh}{\boldsymbol{h}}
    \newcommand{\bsi}{\boldsymbol{i}}
    \newcommand{\bsj}{\boldsymbol{j}}
    \newcommand{\bsk}{\boldsymbol{k}}
    \newcommand{\bsell}{\boldsymbol{\ell}}
    \newcommand{\bsm}{\boldsymbol{m}}
    \newcommand{\bsn}{\boldsymbol{n}}
    \newcommand{\bso}{\boldsymbol{o}}
    \newcommand{\bsp}{\boldsymbol{p}}
    \newcommand{\bsq}{\boldsymbol{q}}
    \newcommand{\bsr}{\boldsymbol{r}}
    \newcommand{\bss}{\boldsymbol{s}}
    \newcommand{\bst}{\boldsymbol{t}}
    \newcommand{\bsu}{\boldsymbol{u}}
    \newcommand{\bsv}{\boldsymbol{v}}
    \newcommand{\bsw}{\boldsymbol{w}}
    \newcommand{\bsx}{\boldsymbol{x}}
    \newcommand{\bsy}{\boldsymbol{y}}
    \newcommand{\bsz}{\boldsymbol{z}}
    \newcommand{\bsA}{\boldsymbol{A}}
    \newcommand{\bsB}{\boldsymbol{B}}
    \newcommand{\bsC}{\boldsymbol{C}}
    \newcommand{\bsD}{\boldsymbol{D}}
    \newcommand{\bsE}{\boldsymbol{E}}
    \newcommand{\bsF}{\boldsymbol{F}}
    \newcommand{\bsG}{\boldsymbol{G}}
    \newcommand{\bsH}{\boldsymbol{H}}
    \newcommand{\bsI}{\boldsymbol{I}}
    \newcommand{\bsJ}{\boldsymbol{J}}
    \newcommand{\bsK}{\boldsymbol{K}}
    \newcommand{\bsL}{\boldsymbol{L}}
    \newcommand{\bsM}{\boldsymbol{M}}
    \newcommand{\bsN}{\boldsymbol{N}}
    \newcommand{\bsP}{\boldsymbol{P}}
    \newcommand{\bsQ}{\boldsymbol{Q}}
    \newcommand{\bsR}{\boldsymbol{R}}
    \newcommand{\bsS}{\boldsymbol{S}}
    \newcommand{\bsT}{\boldsymbol{T}}
    \newcommand{\bsU}{\boldsymbol{U}}
    \newcommand{\bsV}{\boldsymbol{V}}
    \newcommand{\bsW}{\boldsymbol{W}}
    \newcommand{\bsX}{\boldsymbol{X}}
    \newcommand{\bsY}{\boldsymbol{Y}}
    \newcommand{\bsZ}{\boldsymbol{Z}}

    \newcommand{\calA}{\mathcal{A}}
    \newcommand{\calB}{\mathcal{B}}
    \newcommand{\calC}{\mathcal{C}}
    \newcommand{\calD}{\mathcal{D}}
    \newcommand{\calE}{\mathcal{E}}
    \newcommand{\calF}{\mathcal{F}}
    \newcommand{\calG}{\mathcal{G}}
    \newcommand{\calH}{\mathcal{H}}
    \newcommand{\calI}{\mathcal{I}}
    \newcommand{\calJ}{\mathcal{J}}
    \newcommand{\calK}{\mathcal{K}}
    \newcommand{\calL}{\mathcal{L}}
    \newcommand{\calM}{\mathcal{M}}
    \newcommand{\calN}{\mathcal{N}}
    \newcommand{\calO}{\mathcal{O}}
    \newcommand{\calP}{\mathcal{P}}
    \newcommand{\calQ}{\mathcal{Q}}
    \newcommand{\calR}{\mathcal{R}}
    \newcommand{\calS}{\mathcal{S}}
    \newcommand{\calT}{\mathcal{T}}
    \newcommand{\calU}{\mathcal{U}}
    \newcommand{\calV}{\mathcal{V}}
    \newcommand{\calW}{\mathcal{W}}
    \newcommand{\calX}{\mathcal{X}}
    \newcommand{\calY}{\mathcal{Y}}
    \newcommand{\calZ}{\mathcal{Z}}

    \newcommand{\R}{\mathbb{R}}
    \newcommand{\C}{\mathbb{C}}
    \newcommand{\N}{\mathbb{N}}
    \newcommand{\Z}{\mathbb{Z}}
    \newcommand{\F}{\mathbb{F}}
    \newcommand{\Q}{\mathbb{Q}}

    \DeclareMathOperator*{\argmax}{arg\,max}
    \DeclareMathOperator*{\argmin}{arg\,min}
    \newcommand{\nnz}[1]{\mbox{nnz}(#1)}
    \newcommand{\dotprod}[2]{\langle #1, #2 \rangle}

    \newcommand{\ignore}[1]{}

    \let\Pr\relax
    \DeclareMathOperator*{\Pr}{\mathbf{Pr}}
    \newcommand{\E}{\mathbb{E}}
    \DeclareMathOperator*{\Ex}{\mathbf{E}}
    \DeclareMathOperator*{\Var}{\mathbf{Var}}
    \DeclareMathOperator*{\Cov}{\mathbf{Cov}}
    \DeclareMathOperator*{\stddev}{\mathbf{stddev}}
    \DeclareMathOperator*{\avg}{avg}

    \DeclareMathOperator{\poly}{poly}
    \DeclareMathOperator{\polylog}{polylog}
    \DeclareMathOperator{\size}{size}
    \DeclareMathOperator{\sgn}{sgn}
    \DeclareMathOperator{\dist}{dist}
    \DeclareMathOperator{\vol}{vol}
    \DeclareMathOperator{\spn}{span}
    \DeclareMathOperator{\supp}{supp}
    \DeclareMathOperator{\tr}{tr}
    \DeclareMathOperator{\Tr}{Tr}
    \DeclareMathOperator{\codim}{codim}
    \DeclareMathOperator{\diag}{diag}

    \newcommand{\PTIME}{\mathsf{P}}
    \newcommand{\LOGSPACE}{\mathsf{L}}
    \newcommand{\ZPP}{\mathsf{ZPP}}
    \newcommand{\RP}{\mathsf{RP}}
    \newcommand{\BPP}{\mathsf{BPP}}
    \newcommand{\P}{\mathsf{P}}
    \newcommand{\NP}{\mathsf{NP}}
    \newcommand{\TC}{\mathsf{TC}}
    \newcommand{\AC}{\mathsf{AC}}
    \newcommand{\SC}{\mathsf{SC}}
    \newcommand{\SZK}{\mathsf{SZK}}
    \newcommand{\AM}{\mathsf{AM}}
    \newcommand{\IP}{\mathsf{IP}}
    \newcommand{\PSPACE}{\mathsf{PSPACE}}
    \newcommand{\EXP}{\mathsf{EXP}}
    \newcommand{\MIP}{\mathsf{MIP}}
    \newcommand{\NEXP}{\mathsf{NEXP}}
    \newcommand{\BQP}{\mathsf{BQP}}
    \newcommand{\distP}{\mathsf{dist\textbf{P}}}
    \newcommand{\distNP}{\mathsf{dist\textbf{NP}}}

    \newcommand{\eps}{\epsilon}
    \newcommand{\lam}{\lambda}
    \newcommand{\dleta}{\delta}
    \newcommand{\simga}{\sigma}
    \newcommand{\vphi}{\varphi}
    \newcommand{\la}{\langle}
    \newcommand{\ra}{\rangle}
    \newcommand{\wt}[1]{\widetilde{#1}}
    \newcommand{\wh}[1]{\widehat{#1}}
    \newcommand{\ol}[1]{\overline{#1}}
    \newcommand{\ul}[1]{\underline{#1}}
    \newcommand{\ot}{\otimes}
    \newcommand{\zo}{\{0,1\}}
    \newcommand{\co}{:} %\newcommand{\co}{\colon}
    \newcommand{\bdry}{\partial}
    \newcommand{\grad}{\nabla}
    \newcommand{\transp}{^\intercal}
    \newcommand{\inv}{^{-1}}
    \newcommand{\symmdiff}{\triangle} \newcommand{\symdiff}{\symmdiff}
    \newcommand{\half}{\tfrac{1}{2}}
    \newcommand{\bbone}{\mathbbm 1}
    \newcommand{\Id}{\bbone}

    \newcommand{\SAT}{\mathsf{SAT}}

    \newcommand{\bcalG}{\boldsymbol{\calG}}
    \newcommand{\calbG}{\bcalG}
    \newcommand{\bcalX}{\boldsymbol{\calX}} \newcommand{\calbX}{\bcalX}
    \newcommand{\bcalY}{\boldsymbol{\calY}} \newcommand{\calbY}{\bcalY}
    \newcommand{\bcalZ}{\boldsymbol{\calZ}} \newcommand{\calbZ}{\bcalZ}
    $$
</div>

  <header class="post-header">
    <h1 class="post-title">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 3</h1>
    <p class="post-meta">August 1, 2020• fanpu</p>
    <p class="post-tags">
      <a href="/blog/2020"> <i class="fas fa-calendar fa-sm"></i> 2020 </a>
        ·  
        <a href="/blog/tag/rev">
          <i class="fas fa-hashtag fa-sm"></i> rev</a>  
          <a href="/blog/tag/ctf">
          <i class="fas fa-hashtag fa-sm"></i> ctf</a>  
          <a href="/blog/tag/code">
          <i class="fas fa-hashtag fa-sm"></i> code</a>  
          

    </p>
  </header>

  
      <figure>
  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/posts/lily_mountain.webp" class="preview z-depth-1 rounded center" width="100%" height="450px" alt="post.cover" style="object-fit: cover" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>
</figure>

    <div class="caption">
        View from Lily Mountain Trail, Rocky Mountain National Park, Colorado, USA
    </div>
  

  <article class="post-content">
    
    <div id="markdown-content">
      <p>We’re back now with Part 3 of this series on cracking CMU’s Bomblab using Angr!
If you are new, I would recommend starting with Part 1
<a href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-1/">here</a>.</p>

<h3 id="phase-3">Phase 3</h3>

<p>If you went through what we did for phase 2, the idea behind phase 3 is also super similar.</p>

<p>Start again by creating a function stub for phase 3:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="code"><pre><span class="k">def</span> <span class="nf">phase_3</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">path_to_binary</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="nc">Project</span><span class="p">(</span><span class="n">path_to_binary</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Let’s see the disassembly for Phase 3:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td>
<td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">disas</span> <span class="n">phase_3</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="n">phase_3</span><span class="o">:</span>
   <span class="mh">0x0000000000400f43</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x18</span>
   <span class="mh">0x0000000000400f47</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rcx</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0xc</span><span class="p">]</span>
   <span class="mh">0x0000000000400f4c</span> <span class="o">&lt;+</span><span class="mi">9</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rdx</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x0000000000400f51</span> <span class="o">&lt;+</span><span class="mi">14</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="mh">0x4025cf</span>
   <span class="mh">0x0000000000400f56</span> <span class="o">&lt;+</span><span class="mi">19</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000400f5b</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x400bf0</span> <span class="o">&lt;</span><span class="n">__isoc99_sscanf</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f60</span> <span class="o">&lt;+</span><span class="mi">29</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x1</span>
   <span class="mh">0x0000000000400f63</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;:</span>	<span class="n">jg</span>     <span class="mh">0x400f6a</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">39</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f65</span> <span class="o">&lt;+</span><span class="mi">34</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f6a</span> <span class="o">&lt;+</span><span class="mi">39</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">],</span><span class="mh">0x7</span>
   <span class="mh">0x0000000000400f6f</span> <span class="o">&lt;+</span><span class="mi">44</span><span class="o">&gt;:</span>	<span class="n">ja</span>     <span class="mh">0x400fad</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">106</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f71</span> <span class="o">&lt;+</span><span class="mi">46</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x0000000000400f75</span> <span class="o">&lt;+</span><span class="mi">50</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rax</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="mh">0x402470</span><span class="p">]</span>
   <span class="mh">0x0000000000400f7c</span> <span class="o">&lt;+</span><span class="mi">57</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0xcf</span>
   <span class="mh">0x0000000000400f81</span> <span class="o">&lt;+</span><span class="mi">62</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x400fbe</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f83</span> <span class="o">&lt;+</span><span class="mi">64</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x2c3</span>
   <span class="mh">0x0000000000400f88</span> <span class="o">&lt;+</span><span class="mi">69</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x400fbe</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f8a</span> <span class="o">&lt;+</span><span class="mi">71</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x100</span>
   <span class="mh">0x0000000000400f8f</span> <span class="o">&lt;+</span><span class="mi">76</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x400fbe</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f91</span> <span class="o">&lt;+</span><span class="mi">78</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x185</span>
   <span class="mh">0x0000000000400f96</span> <span class="o">&lt;+</span><span class="mi">83</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x400fbe</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f98</span> <span class="o">&lt;+</span><span class="mi">85</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0xce</span>
   <span class="mh">0x0000000000400f9d</span> <span class="o">&lt;+</span><span class="mi">90</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x400fbe</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400f9f</span> <span class="o">&lt;+</span><span class="mi">92</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x2aa</span>
   <span class="mh">0x0000000000400fa4</span> <span class="o">&lt;+</span><span class="mi">97</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x400fbe</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400fa6</span> <span class="o">&lt;+</span><span class="mi">99</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x147</span>
   <span class="mh">0x0000000000400fab</span> <span class="o">&lt;+</span><span class="mi">104</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x400fbe</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400fad</span> <span class="o">&lt;+</span><span class="mi">106</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400fb2</span> <span class="o">&lt;+</span><span class="mi">111</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000400fb7</span> <span class="o">&lt;+</span><span class="mi">116</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x400fbe</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400fb9</span> <span class="o">&lt;+</span><span class="mi">118</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x137</span>
   <span class="mh">0x0000000000400fbe</span> <span class="o">&lt;+</span><span class="mi">123</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0xc</span><span class="p">]</span>
   <span class="mh">0x0000000000400fc2</span> <span class="o">&lt;+</span><span class="mi">127</span><span class="o">&gt;:</span>	<span class="n">je</span>     <span class="mh">0x400fc9</span> <span class="o">&lt;</span><span class="n">phase_3</span><span class="o">+</span><span class="mi">134</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400fc4</span> <span class="o">&lt;+</span><span class="mi">129</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400fc9</span> <span class="o">&lt;+</span><span class="mi">134</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x18</span>
   <span class="mh">0x0000000000400fcd</span> <span class="o">&lt;+</span><span class="mi">138</span><span class="o">&gt;:</span>	<span class="n">ret</span>    
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>We see a <code class="language-plaintext highlighter-rouge">sscanf</code> call, which reads formatted input from a string. This is probably what builds the arguments, based on the previous <code class="language-plaintext highlighter-rouge">read_line</code> call, since <code class="language-plaintext highlighter-rouge">rdi</code> is not modified before <code class="language-plaintext highlighter-rouge">sscanf</code> is called. Let’s check out the format string that was passed in:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">x</span><span class="o">/</span><span class="n">s</span> <span class="mh">0x4025cf</span>
<span class="mh">0x4025cf</span><span class="o">:</span>	<span class="s">"%d %d"</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Cool, so two integers. We can follow more or less the same format as in Phase 2 by pushing these two values onto the stack. We define the start address to be the instruction after the <code class="language-plaintext highlighter-rouge">sscanf</code> call:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="code"><pre>    <span class="n">start_addr</span> <span class="o">=</span> <span class="mh">0x00400f60</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">blank_state</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="n">start_addr</span><span class="p">)</span>

    <span class="n">num_12</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="nc">BVS</span><span class="p">(</span><span class="sh">'</span><span class="s">num_12</span><span class="sh">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

    <span class="n">initial_state</span><span class="p">.</span><span class="nf">stack_push</span><span class="p">(</span><span class="n">num_12</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>However, there is one major difference. In Phase 2, our arguments were at the bottom of the stack, and so we could just push them onto the stack. However, in this case, we see that we have a stack size of 0x18 from line 3, but the addresses of the two arguments that were populated by <code class="language-plaintext highlighter-rouge">sscanf</code> are <code class="language-plaintext highlighter-rouge">rsp + 0xc</code> and <code class="language-plaintext highlighter-rouge">rsp + 0x8</code> respectively. This means that we need an additional 8 bytes of padding afterwards:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td>
<td class="code"><pre>    <span class="n">padding_length_in_bytes</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsp</span> <span class="o">-=</span> <span class="n">padding_length_in_bytes</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Let’s set our find condition to be right before the <code class="language-plaintext highlighter-rouge">ret</code>, and avoid to be <code class="language-plaintext highlighter-rouge">explode_bomb</code> as usual, and then copy and paste what we had for Phase 2 to extract the solution:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td>
<td class="code"><pre>    <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">simgr</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>

    <span class="n">success_addr</span> <span class="o">=</span> <span class="mh">0x00400fcd</span> <span class="c1"># right before ret
</span>    <span class="n">explode_addr</span> <span class="o">=</span> <span class="mh">0x0040143a</span> <span class="c1"># explode_bomb
</span>
    <span class="n">simulation</span><span class="p">.</span><span class="nf">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">success_addr</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

    <span class="c1"># Check that we have found a solution
</span>    <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">:</span>
        <span class="n">solution_state</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">num_12_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="nf">eval</span><span class="p">(</span><span class="n">num_12</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">unpack_ints</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">lower_32_mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">)</span>

        <span class="n">num_1_sol</span><span class="p">,</span> <span class="n">num_2_sol</span> <span class="o">=</span> <span class="nf">unpack_ints</span><span class="p">(</span><span class="n">num_12_sol</span><span class="p">)</span>

        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">num_1_sol</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">num_2_sol</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">'</span><span class="s">Could not find the solution</span><span class="sh">'</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<h3 id="full-solution-script">Full Solution Script</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td>
<td class="code"><pre><span class="kn">import</span> <span class="n">angr</span>
<span class="kn">import</span> <span class="n">claripy</span>
<span class="kn">import</span> <span class="n">sys</span>

<span class="k">def</span> <span class="nf">phase_3</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">path_to_binary</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="nc">Project</span><span class="p">(</span><span class="n">path_to_binary</span><span class="p">)</span>

    <span class="c1"># Tell Angr where to start executing 
</span>    <span class="n">start_addr</span> <span class="o">=</span> <span class="mh">0x00400f60</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">blank_state</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="n">start_addr</span><span class="p">)</span>

    <span class="n">num_12</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="nc">BVS</span><span class="p">(</span><span class="sh">'</span><span class="s">num_12</span><span class="sh">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

    <span class="n">initial_state</span><span class="p">.</span><span class="nf">stack_push</span><span class="p">(</span><span class="n">num_12</span><span class="p">)</span>

    <span class="n">padding_length_in_bytes</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsp</span> <span class="o">-=</span> <span class="n">padding_length_in_bytes</span>

    <span class="c1"># Create a simulation manager initialized with the starting state
</span>    <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">simgr</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>

    <span class="n">success_addr</span> <span class="o">=</span> <span class="mh">0x00400fcd</span> <span class="c1"># right before ret
</span>    <span class="n">explode_addr</span> <span class="o">=</span> <span class="mh">0x0040143a</span> <span class="c1"># explode_bomb
</span>
    <span class="n">simulation</span><span class="p">.</span><span class="nf">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">success_addr</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

    <span class="c1"># Check that we have found a solution
</span>    <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">:</span>
        <span class="n">solution_state</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">num_12_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="nf">eval</span><span class="p">(</span><span class="n">num_12</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">unpack_ints</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">lower_32_mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">)</span>

        <span class="n">num_1_sol</span><span class="p">,</span> <span class="n">num_2_sol</span> <span class="o">=</span> <span class="nf">unpack_ints</span><span class="p">(</span><span class="n">num_12_sol</span><span class="p">)</span>

        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">num_1_sol</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">num_2_sol</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">'</span><span class="s">Could not find the solution</span><span class="sh">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">phase_3</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Let’s try running it:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td>
<td class="code"><pre><span class="err">$</span> <span class="n">solve</span><span class="p">.</span><span class="n">py</span> <span class="n">bomb</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">368</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">The</span> <span class="n">program</span> <span class="n">is</span> <span class="n">accessing</span> <span class="n">memory</span> <span class="n">or</span> <span class="n">registers</span> <span class="n">with</span> <span class="n">an</span> <span class="n">unspecified</span> <span class="n">value</span><span class="p">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">indicate</span> <span class="n">unwanted</span> <span class="n">behavior</span><span class="p">.</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">368</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">angr</span> <span class="n">will</span> <span class="n">cope</span> <span class="n">with</span> <span class="n">this</span> <span class="n">by</span> <span class="n">generating</span> <span class="n">an</span> <span class="n">unconstrained</span> <span class="n">symbolic</span> <span class="n">variable</span> <span class="n">and</span> <span class="n">continuing</span><span class="p">.</span> <span class="n">You</span> <span class="n">can</span> <span class="n">resolve</span> <span class="n">this</span> <span class="n">by</span><span class="o">:</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">368</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">1</span><span class="p">)</span> <span class="n">setting</span> <span class="n">a</span> <span class="n">value</span> <span class="n">to</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">state</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">369</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">2</span><span class="p">)</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">state</span> <span class="n">option</span> <span class="n">ZERO_FILL_UNCONSTRAINED_</span><span class="p">{</span><span class="n">MEMORY</span><span class="p">,</span><span class="n">REGISTERS</span><span class="p">},</span> <span class="n">to</span> <span class="n">make</span> <span class="n">unknown</span> <span class="n">regions</span> <span class="n">hold</span> <span class="n">null</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">369</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">3</span><span class="p">)</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">state</span> <span class="n">option</span> <span class="n">SYMBOL_FILL_UNCONSTRAINED_</span><span class="p">{</span><span class="n">MEMORY_REGISTERS</span><span class="p">},</span> <span class="n">to</span> <span class="n">suppress</span> <span class="n">these</span> <span class="n">messages</span><span class="p">.</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">16</span><span class="p">,</span><span class="mi">369</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">Filling</span> <span class="k">register</span> <span class="n">rax</span> <span class="n">with</span> <span class="mi">8</span> <span class="n">unconstrained</span> <span class="n">bytes</span> <span class="n">referenced</span> <span class="n">from</span> <span class="mh">0x400f60</span> <span class="p">(</span><span class="n">phase_3</span><span class="o">+</span><span class="mh">0x1d</span> <span class="n">in</span> <span class="n">bomb</span> <span class="p">(</span><span class="mh">0x400f60</span><span class="p">))</span>
<span class="n">CRITICAL</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">42</span><span class="o">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">120</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">sim_state</span> <span class="o">|</span> <span class="n">The</span> <span class="n">name</span> <span class="n">state</span><span class="p">.</span><span class="n">se</span> <span class="n">is</span> <span class="n">deprecated</span><span class="p">;</span> <span class="n">please</span> <span class="n">use</span> <span class="n">state</span><span class="p">.</span><span class="n">solver</span><span class="p">.</span>
<span class="mi">1</span> <span class="mi">311</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Now using the solution on the actual bomb:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td>
<td class="code"><pre><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">bomb</span>
<span class="n">Welcome</span> <span class="n">to</span> <span class="n">my</span> <span class="n">fiendish</span> <span class="n">little</span> <span class="n">bomb</span><span class="p">.</span> <span class="n">You</span> <span class="n">have</span> <span class="mi">6</span> <span class="n">phases</span> <span class="n">with</span>
<span class="n">which</span> <span class="n">to</span> <span class="n">blow</span> <span class="n">yourself</span> <span class="n">up</span><span class="p">.</span> <span class="n">Have</span> <span class="n">a</span> <span class="n">nice</span> <span class="n">day</span><span class="o">!</span>
<span class="n">Border</span> <span class="n">relations</span> <span class="n">with</span> <span class="n">Canada</span> <span class="n">have</span> <span class="n">never</span> <span class="n">been</span> <span class="n">better</span><span class="p">.</span>
<span class="n">Phase</span> <span class="mi">1</span> <span class="n">defused</span><span class="p">.</span> <span class="n">How</span> <span class="n">about</span> <span class="n">the</span> <span class="n">next</span> <span class="n">one</span><span class="o">?</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">8</span> <span class="mi">16</span> <span class="mi">32</span>
<span class="n">That</span><span class="err">'</span><span class="n">s</span> <span class="n">number</span> <span class="mi">2</span><span class="p">.</span>  <span class="n">Keep</span> <span class="n">going</span><span class="o">!</span>
<span class="mi">1</span> <span class="mi">311</span>
<span class="n">Halfway</span> <span class="n">there</span><span class="o">!</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Nice, it worked, and this was pretty fast too given how similar it was to phase
2! You can continue to Part 4
<a href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-4/">here</a>.</p>

    </div>
  </article>


  
    
    <br>
    <hr>
    <br>
    <ul class="list-disc pl-8"></ul>

    <!-- Adds related posts to the end of an article -->
    <!-- <p class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</p> -->
    <p class="mb-2">Related Posts:</p>
  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/setting-up-yuancon-controller-sound-voltex/">Playing Sound Voltex at Home: Setting Up Unnamed SDVX Clone with the Yuancon SDVX Controller</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/creating-trackback-requests/">Creating Trackback Requests for Static Sites</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/high-dimensional-analysis-of-m-estimators/">A Unified Framework for High-Dimensional Analysis of M-Estimators with Decomposable Regularizers: A Guided Walkthrough</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/cmu-steam-tunnels/">The CMU Steam Tunnels and Wean 9</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/advanced-operating-systems-course-review/">CMU 15712 Advanced Operating Systems and Distributed Systems Course Review</a>
  </li>

<div id="giscus_thread" style="max-width: 800px; margin: 0 auto;">
  <script>
    let giscusTheme = localStorage.getItem("theme");
    let giscusAttributes = {
        "src": "https://giscus.app/client.js",
        "data-repo": "fanpu/website",
        "data-repo-id": "R_kgDOIpOodA",
        "data-category": "General",
        "data-category-id": "DIC_kwDOIpOodM4CTKDC",
        "data-mapping": "title",
        "data-strict": "1",
        "data-reactions-enabled": "1",
        "data-emit-metadata": "0",
        "data-input-position": "top",
        "data-theme": giscusTheme,
        "data-lang": "en",
        "crossorigin": "anonymous",
        "async": "",
    };


    let giscusScript = document.createElement("script");
    Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
    document.getElementById("giscus_thread").appendChild(giscusScript);
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a>
</noscript>
</div>
</div>

          </div>
        </div>
        
      
    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2024 Fan Pu  Zeng. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme.
Last updated: July 21, 2024.
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Enable Tooltips -->
  <script type="text/javascript">
  $(function () {$('[data-toggle="tooltip"]').tooltip()})
  </script>
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script>
  <!-- Sidebar Table of Contents -->
  <script defer src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script>


  <!-- Bootstrap Table -->
  <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script>

  <!-- Load Common JS -->
  <script src="/assets/js/no_defer.js"></script>
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      loader: {load: ['[tex]/mathtools']},
      tex: {
        packages: {'[+]': ['mathtools', 'ams']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          addMenu: []
        }
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
