<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Breaking CMU's Bomblab with Angr for Fun and Profit - Part 7 | Fan Pu Zeng </title> <meta name="author" content="Fan Pu Zeng"> <meta name="description" content="The final part of cracking CMU's Bomblab with Angr, where we crack the secret phase together!"> <meta name="keywords" content="fanpu, fan pu, fanpu zeng, fan pu zeng, zengfanpu, fanpuzeng, fzeng, CMU, cmu, carnegie mellon, cmu courses, school of computer science, scs, machine learning, computer science, ml, theory, courses, course reviews, CS, Jane Street"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/favicon_new.ico?426605099301e95aedae716cc398b951"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://fanpu.io/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-7/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Fan Pu</span> Zeng </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/courses/">CMU Course Reviews </a> </li> <li class="nav-item "> <a class="nav-link" href="/cmu-online/">CMU Online </a> </li> <li class="nav-item "> <a class="nav-link" href="/summaries/">ML Paper Summaries </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 7</h1> <p class="post-meta"> Created in August 02, 2020 by fanpu </p> <p class="post-tags"> <a href="/blog/2020"> <i class="fa-solid fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/rev"> <i class="fa-solid fa-hashtag fa-sm"></i> rev</a>   <a href="/blog/tag/ctf"> <i class="fa-solid fa-hashtag fa-sm"></i> ctf</a>   <a href="/blog/tag/code"> <i class="fa-solid fa-hashtag fa-sm"></i> code</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Welcome to the final part of cracking CMU’s Bomblab with Angr. If you are new here, I would recommend starting with part 1 <a href="breaking-cmu-bomblab-with-angr-for-fun-and-profit">here</a>.</p> <h3 id="secret-phase">Secret Phase</h3> <p>We knew about the secret phase because we literally saw the string “Wow! You’ve defused the secret stage!” from Angr’s output for Phase 1, because the string was located right after the compare string for Phase 1in memory. If we do <code class="language-plaintext highlighter-rouge">info func</code> in GDB, we indeed see a <code class="language-plaintext highlighter-rouge">secret_phase</code> and <code class="language-plaintext highlighter-rouge">fun7</code> function.</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">info</span> <span class="n">func</span>
<span class="p">[...]</span>
<span class="mh">0x0000000000401204</span>  <span class="n">fun7</span>
<span class="mh">0x0000000000401242</span>  <span class="n">secret_phase</span>
<span class="p">[...]</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Let’s check <code class="language-plaintext highlighter-rouge">fun7</code> first:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">disas</span> <span class="n">fun7</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="n">fun7</span><span class="o">:</span>
   <span class="mh">0x0000000000401204</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x8</span>
   <span class="mh">0x0000000000401208</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	<span class="n">test</span>   <span class="n">rdi</span><span class="p">,</span><span class="n">rdi</span>
   <span class="mh">0x000000000040120b</span> <span class="o">&lt;+</span><span class="mi">7</span><span class="o">&gt;:</span>	<span class="n">je</span>     <span class="mh">0x401238</span> <span class="o">&lt;</span><span class="n">fun7</span><span class="o">+</span><span class="mi">52</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040120d</span> <span class="o">&lt;+</span><span class="mi">9</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rdi</span><span class="p">]</span>
   <span class="mh">0x000000000040120f</span> <span class="o">&lt;+</span><span class="mi">11</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">edx</span><span class="p">,</span><span class="n">esi</span>
   <span class="mh">0x0000000000401211</span> <span class="o">&lt;+</span><span class="mi">13</span><span class="o">&gt;:</span>	<span class="n">jle</span>    <span class="mh">0x401220</span> <span class="o">&lt;</span><span class="n">fun7</span><span class="o">+</span><span class="mi">28</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401213</span> <span class="o">&lt;+</span><span class="mi">15</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rdi</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x0000000000401217</span> <span class="o">&lt;+</span><span class="mi">19</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x401204</span> <span class="o">&lt;</span><span class="n">fun7</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040121c</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>
   <span class="mh">0x000000000040121e</span> <span class="o">&lt;+</span><span class="mi">26</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x40123d</span> <span class="o">&lt;</span><span class="n">fun7</span><span class="o">+</span><span class="mi">57</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401220</span> <span class="o">&lt;+</span><span class="mi">28</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000401225</span> <span class="o">&lt;+</span><span class="mi">33</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">edx</span><span class="p">,</span><span class="n">esi</span>
   <span class="mh">0x0000000000401227</span> <span class="o">&lt;+</span><span class="mi">35</span><span class="o">&gt;:</span>	<span class="n">je</span>     <span class="mh">0x40123d</span> <span class="o">&lt;</span><span class="n">fun7</span><span class="o">+</span><span class="mi">57</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401229</span> <span class="o">&lt;+</span><span class="mi">37</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">QWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rdi</span><span class="o">+</span><span class="mh">0x10</span><span class="p">]</span>
   <span class="mh">0x000000000040122d</span> <span class="o">&lt;+</span><span class="mi">41</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x401204</span> <span class="o">&lt;</span><span class="n">fun7</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401232</span> <span class="o">&lt;+</span><span class="mi">46</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">eax</span><span class="p">,[</span><span class="n">rax</span><span class="o">+</span><span class="n">rax</span><span class="o">*</span><span class="mi">1</span><span class="o">+</span><span class="mh">0x1</span><span class="p">]</span>
   <span class="mh">0x0000000000401236</span> <span class="o">&lt;+</span><span class="mi">50</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x40123d</span> <span class="o">&lt;</span><span class="n">fun7</span><span class="o">+</span><span class="mi">57</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401238</span> <span class="o">&lt;+</span><span class="mi">52</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0xffffffff</span>
   <span class="mh">0x000000000040123d</span> <span class="o">&lt;+</span><span class="mi">57</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x8</span>
   <span class="mh">0x0000000000401241</span> <span class="o">&lt;+</span><span class="mi">61</span><span class="o">&gt;:</span>	<span class="n">ret</span>    
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Nothing out of the ordinary here, it is entirely self contained, so we can blackbox it.</p> <p>Let’s now disassemble <code class="language-plaintext highlighter-rouge">secret_phase</code>:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">disas</span> <span class="n">secret_phase</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="n">secret_phase</span><span class="o">:</span>
   <span class="mh">0x0000000000401242</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	<span class="n">push</span>   <span class="n">rbx</span>
   <span class="mh">0x0000000000401243</span> <span class="o">&lt;+</span><span class="mi">1</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40149e</span> <span class="o">&lt;</span><span class="n">read_line</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401248</span> <span class="o">&lt;+</span><span class="mi">6</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0xa</span>
   <span class="mh">0x000000000040124d</span> <span class="o">&lt;+</span><span class="mi">11</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000401252</span> <span class="o">&lt;+</span><span class="mi">16</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rdi</span><span class="p">,</span><span class="n">rax</span>
   <span class="mh">0x0000000000401255</span> <span class="o">&lt;+</span><span class="mi">19</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x400bd0</span> <span class="o">&lt;</span><span class="n">strtol</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040125a</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">rbx</span><span class="p">,</span><span class="n">rax</span>
   <span class="mh">0x000000000040125d</span> <span class="o">&lt;+</span><span class="mi">27</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">eax</span><span class="p">,[</span><span class="n">rax</span><span class="o">-</span><span class="mh">0x1</span><span class="p">]</span>
   <span class="mh">0x0000000000401260</span> <span class="o">&lt;+</span><span class="mi">30</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x3e8</span>
   <span class="mh">0x0000000000401265</span> <span class="o">&lt;+</span><span class="mi">35</span><span class="o">&gt;:</span>	<span class="n">jbe</span>    <span class="mh">0x40126c</span> <span class="o">&lt;</span><span class="n">secret_phase</span><span class="o">+</span><span class="mi">42</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401267</span> <span class="o">&lt;+</span><span class="mi">37</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040126c</span> <span class="o">&lt;+</span><span class="mi">42</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="n">ebx</span>
   <span class="mh">0x000000000040126e</span> <span class="o">&lt;+</span><span class="mi">44</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edi</span><span class="p">,</span><span class="mh">0x6030f0</span>
   <span class="mh">0x0000000000401273</span> <span class="o">&lt;+</span><span class="mi">49</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x401204</span> <span class="o">&lt;</span><span class="n">fun7</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401278</span> <span class="o">&lt;+</span><span class="mi">54</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x2</span>
   <span class="mh">0x000000000040127b</span> <span class="o">&lt;+</span><span class="mi">57</span><span class="o">&gt;:</span>	<span class="n">je</span>     <span class="mh">0x401282</span> <span class="o">&lt;</span><span class="n">secret_phase</span><span class="o">+</span><span class="mi">64</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040127d</span> <span class="o">&lt;+</span><span class="mi">59</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401282</span> <span class="o">&lt;+</span><span class="mi">64</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edi</span><span class="p">,</span><span class="mh">0x402438</span>
   <span class="mh">0x0000000000401287</span> <span class="o">&lt;+</span><span class="mi">69</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x400b10</span> <span class="o">&lt;</span><span class="n">puts</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040128c</span> <span class="o">&lt;+</span><span class="mi">74</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x4015c4</span> <span class="o">&lt;</span><span class="n">phase_defused</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401291</span> <span class="o">&lt;+</span><span class="mi">79</span><span class="o">&gt;:</span>	<span class="n">pop</span>    <span class="n">rbx</span>
   <span class="mh">0x0000000000401292</span> <span class="o">&lt;+</span><span class="mi">80</span><span class="o">&gt;:</span>	<span class="n">ret</span>    
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Pretty standard, no new gotchas here. We can start executing after the <code class="language-plaintext highlighter-rouge">strtol</code> function call, and then set a symbolic int to <code class="language-plaintext highlighter-rouge">rax</code>:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td> <td class="code"><pre><span class="k">def</span> <span class="nf">secret_phase</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">path_to_binary</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="nc">Project</span><span class="p">(</span><span class="n">path_to_binary</span><span class="p">)</span>

    <span class="c1"># Tell Angr where to start executing 
</span>    <span class="n">start_addr</span> <span class="o">=</span> <span class="mh">0x0040125a</span> <span class="c1"># right after strtol
</span>    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">blank_state</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="n">start_addr</span><span class="p">)</span>

    <span class="n">num</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="nc">BVS</span><span class="p">(</span><span class="sh">'</span><span class="s">secret_phase_input</span><span class="sh">'</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="c1"># 32 bits
</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rax</span> <span class="o">=</span> <span class="n">num</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>The success address will be right before ret as usual. In order to get the result, we cast the symbolic output to an int.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td> <td class="code"><pre>    <span class="c1"># Create a simulation manager initialized with the starting state
</span>    <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">simgr</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>

    <span class="n">success_addr</span> <span class="o">=</span> <span class="mh">0x00401292</span> <span class="c1"># right before ret
</span>    <span class="n">explode_addr</span> <span class="o">=</span> <span class="mh">0x0040143a</span> <span class="c1"># explode_bomb
</span>
    <span class="n">simulation</span><span class="p">.</span><span class="nf">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">success_addr</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">:</span>
        <span class="n">solution_state</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Case symbolic value to int 
</span>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="nf">eval</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">'</span><span class="s">Could not find the solution</span><span class="sh">'</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <h3 id="full-solution-script">Full Solution Script</h3> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td> <td class="code"><pre><span class="n">import</span> <span class="n">angr</span>
<span class="n">import</span> <span class="n">claripy</span>
<span class="n">import</span> <span class="n">sys</span>

<span class="n">def</span> <span class="n">secret_phase</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span><span class="o">:</span>
    <span class="n">path_to_binary</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="n">Project</span><span class="p">(</span><span class="n">path_to_binary</span><span class="p">)</span>

    <span class="cp"># Tell Angr where to start executing 
</span>    <span class="n">start_addr</span> <span class="o">=</span> <span class="mh">0x0040125a</span> <span class="err">#</span> <span class="n">right</span> <span class="n">after</span> <span class="n">strtol</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">blank_state</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="n">start_addr</span><span class="p">)</span>

    <span class="n">num</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="n">BVS</span><span class="p">(</span><span class="err">'</span><span class="n">secret_phase_input</span><span class="err">'</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="err">#</span> <span class="mi">32</span> <span class="n">bits</span>

    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rax</span> <span class="o">=</span> <span class="n">num</span>

    <span class="cp"># Create a simulation manager initialized with the starting state
</span>    <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">simgr</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>

    <span class="n">success_addr</span> <span class="o">=</span> <span class="mh">0x00401292</span> <span class="err">#</span> <span class="n">right</span> <span class="n">before</span> <span class="n">ret</span>
    <span class="n">explode_addr</span> <span class="o">=</span> <span class="mh">0x0040143a</span> <span class="err">#</span> <span class="n">explode_bomb</span>

    <span class="n">simulation</span><span class="p">.</span><span class="n">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">success_addr</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="o">:</span>
        <span class="n">solution_state</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="cp"># Case symbolic value to int 
</span>        <span class="n">solution</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="n">eval</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="kt">int</span><span class="p">)</span>
        <span class="n">print</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
    <span class="k">else</span><span class="o">:</span>
        <span class="n">raise</span> <span class="n">Exception</span><span class="p">(</span><span class="err">'</span><span class="n">Could</span> <span class="n">not</span> <span class="n">find</span> <span class="n">the</span> <span class="n">solution</span><span class="err">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="err">'</span><span class="n">__main__</span><span class="err">'</span><span class="o">:</span>
    <span class="n">secret_phase</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>If we run it, we get the following:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td> <td class="code"><pre><span class="err">$</span> <span class="n">python</span> <span class="n">solve</span><span class="p">.</span><span class="n">py</span> <span class="n">bomb</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">04</span> <span class="mo">00</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mo">02</span><span class="p">,</span><span class="mi">736</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">The</span> <span class="n">program</span> <span class="n">is</span> <span class="n">accessing</span> <span class="n">memory</span> <span class="n">or</span> <span class="n">registers</span> <span class="n">with</span> <span class="n">an</span> <span class="n">unspecified</span> <span class="n">value</span><span class="p">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">indicate</span> <span class="n">unwanted</span> <span class="n">behavior</span><span class="p">.</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">04</span> <span class="mo">00</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mo">02</span><span class="p">,</span><span class="mi">736</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">angr</span> <span class="n">will</span> <span class="n">cope</span> <span class="n">with</span> <span class="n">this</span> <span class="n">by</span> <span class="n">generating</span> <span class="n">an</span> <span class="n">unconstrained</span> <span class="n">symbolic</span> <span class="n">variable</span> <span class="n">and</span> <span class="n">continuing</span><span class="p">.</span> <span class="n">You</span> <span class="n">can</span> <span class="n">resolve</span> <span class="n">this</span> <span class="n">by</span><span class="o">:</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">04</span> <span class="mo">00</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mo">02</span><span class="p">,</span><span class="mi">736</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">1</span><span class="p">)</span> <span class="n">setting</span> <span class="n">a</span> <span class="n">value</span> <span class="n">to</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">state</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">04</span> <span class="mo">00</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mo">02</span><span class="p">,</span><span class="mi">736</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">2</span><span class="p">)</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">state</span> <span class="n">option</span> <span class="n">ZERO_FILL_UNCONSTRAINED_</span><span class="p">{</span><span class="n">MEMORY</span><span class="p">,</span><span class="n">REGISTERS</span><span class="p">},</span> <span class="n">to</span> <span class="n">make</span> <span class="n">unknown</span> <span class="n">regions</span> <span class="n">hold</span> <span class="n">null</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">04</span> <span class="mo">00</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mo">02</span><span class="p">,</span><span class="mi">737</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">3</span><span class="p">)</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">state</span> <span class="n">option</span> <span class="n">SYMBOL_FILL_UNCONSTRAINED_</span><span class="p">{</span><span class="n">MEMORY_REGISTERS</span><span class="p">},</span> <span class="n">to</span> <span class="n">suppress</span> <span class="n">these</span> <span class="n">messages</span><span class="p">.</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">04</span> <span class="mo">00</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mo">02</span><span class="p">,</span><span class="mi">737</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">Filling</span> <span class="n">memory</span> <span class="n">at</span> <span class="mh">0x7fffffffffefff8</span> <span class="n">with</span> <span class="mi">8</span> <span class="n">unconstrained</span> <span class="n">bytes</span> <span class="n">referenced</span> <span class="n">from</span> <span class="mh">0x401291</span> <span class="p">(</span><span class="n">secret_phase</span><span class="o">+</span><span class="mh">0x4f</span> <span class="n">in</span> <span class="n">bomb</span> <span class="p">(</span><span class="mh">0x401291</span><span class="p">))</span>
<span class="n">CRITICAL</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">04</span> <span class="mo">00</span><span class="o">:</span><span class="mo">07</span><span class="o">:</span><span class="mo">02</span><span class="p">,</span><span class="mi">812</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">sim_state</span> <span class="o">|</span> <span class="n">The</span> <span class="n">name</span> <span class="n">state</span><span class="p">.</span><span class="n">se</span> <span class="n">is</span> <span class="n">deprecated</span><span class="p">;</span> <span class="n">please</span> <span class="n">use</span> <span class="n">state</span><span class="p">.</span><span class="n">solver</span><span class="p">.</span>
<span class="mi">22</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>We got the answer fairly quickly! If you had done Bomblab before and did the secret phase, you would remember that <code class="language-plaintext highlighter-rouge">fun7</code> was a tricky little recursive function, but Angr just crushed it so easily!</p> <p>Now, we get to the question of how the secret stage can actually be triggered. Unfortunately, I could not really find a way to do this symbolically with Angr due to the state explosion problem. This is because there is quite a big gap between when the input is set, and when the condition to go into the secret phase is satisfied.</p> <p>To make it clearer about what I mean, I decided to just tell you how it works, because ultimately this is a series on learning about Angr and not learning how to reverse. Basically, <code class="language-plaintext highlighter-rouge">read_line</code> keeps track of a global variable <code class="language-plaintext highlighter-rouge">num_input_strings</code> which increments by 1 each time it is called. It then uses this as an index into a global buffer, and this buffer is used to store the input by the user for each stage. When <code class="language-plaintext highlighter-rouge">num_input_strings</code> is 6 (i.e we cleared all stages) we perform the following check in <code class="language-plaintext highlighter-rouge">phase_defused</code>:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td> <td class="code"><pre>   <span class="mh">0x00000000004015d8</span> <span class="o">&lt;+</span><span class="mi">20</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rip</span><span class="o">+</span><span class="mh">0x202181</span><span class="p">],</span><span class="mh">0x6</span>        <span class="err">#</span> <span class="mh">0x603760</span> <span class="o">&lt;</span><span class="n">num_input_strings</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004015df</span> <span class="o">&lt;+</span><span class="mi">27</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x40163f</span> <span class="o">&lt;</span><span class="n">phase_defused</span><span class="o">+</span><span class="mi">123</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004015e1</span> <span class="o">&lt;+</span><span class="mi">29</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">r8</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x10</span><span class="p">]</span>
   <span class="mh">0x00000000004015e6</span> <span class="o">&lt;+</span><span class="mi">34</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rcx</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0xc</span><span class="p">]</span>
   <span class="mh">0x00000000004015eb</span> <span class="o">&lt;+</span><span class="mi">39</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rdx</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x00000000004015f0</span> <span class="o">&lt;+</span><span class="mi">44</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="mh">0x402619</span>
   <span class="mh">0x00000000004015f5</span> <span class="o">&lt;+</span><span class="mi">49</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edi</span><span class="p">,</span><span class="mh">0x603870</span>
   <span class="mh">0x00000000004015fa</span> <span class="o">&lt;+</span><span class="mi">54</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x400bf0</span> <span class="o">&lt;</span><span class="n">__isoc99_sscanf</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
   <span class="mh">0x00000000004015ff</span> <span class="o">&lt;+</span><span class="mi">59</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x3</span>
   <span class="mh">0x0000000000401602</span> <span class="o">&lt;+</span><span class="mi">62</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x401635</span> <span class="o">&lt;</span><span class="n">phase_defused</span><span class="o">+</span><span class="mi">113</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401604</span> <span class="o">&lt;+</span><span class="mi">64</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="mh">0x402622</span>
   <span class="mh">0x0000000000401609</span> <span class="o">&lt;+</span><span class="mi">69</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rdi</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x10</span><span class="p">]</span>
   <span class="mh">0x000000000040160e</span> <span class="o">&lt;+</span><span class="mi">74</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x401338</span> <span class="o">&lt;</span><span class="n">strings_not_equal</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401613</span> <span class="o">&lt;+</span><span class="mi">79</span><span class="o">&gt;:</span>	<span class="n">test</span>   <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>
   <span class="mh">0x0000000000401615</span> <span class="o">&lt;+</span><span class="mi">81</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x401635</span> <span class="o">&lt;</span><span class="n">phase_defused</span><span class="o">+</span><span class="mi">113</span><span class="o">&gt;</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>It just happens that the global buffer used by Phase 4 is the one that is pointed to by the <code class="language-plaintext highlighter-rouge">rdi</code> argument for <code class="language-plaintext highlighter-rouge">sscanf</code>, <code class="language-plaintext highlighter-rouge">0x603870</code>. This is the most clear if you use dynamic analysis to inspect the value of the buffer after setting a breakpoint at this point, where you will see your Phase 4 input in the buffer.</p> <p>The format string used for <code class="language-plaintext highlighter-rouge">sscanf</code> is as follows:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">x</span><span class="o">/</span><span class="n">s</span> <span class="mh">0x402619</span>
<span class="mh">0x402619</span><span class="o">:</span>	<span class="s">"%d %d %s"</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>So we only continue down if we extract all three tokens, and with the third token being “DrEvil”:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">x</span><span class="o">/</span><span class="n">s</span> <span class="mh">0x402622</span>
<span class="mh">0x402622</span><span class="o">:</span>	<span class="s">"DrEvil"</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>This means that all we need to do to trigger the secret phase is to change our Phase 4 input from <code class="language-plaintext highlighter-rouge">7 0 </code> to <code class="language-plaintext highlighter-rouge">7 0 DrEvil</code>!</p> <p>Trying it out on the actual binary:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td> <td class="code"><pre><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">bomb</span>
<span class="n">Welcome</span> <span class="n">to</span> <span class="n">my</span> <span class="n">fiendish</span> <span class="n">little</span> <span class="n">bomb</span><span class="p">.</span> <span class="n">You</span> <span class="n">have</span> <span class="mi">6</span> <span class="n">phases</span> <span class="n">with</span>
<span class="n">which</span> <span class="n">to</span> <span class="n">blow</span> <span class="n">yourself</span> <span class="n">up</span><span class="p">.</span> <span class="n">Have</span> <span class="n">a</span> <span class="n">nice</span> <span class="n">day</span><span class="o">!</span>
<span class="n">Border</span> <span class="n">relations</span> <span class="n">with</span> <span class="n">Canada</span> <span class="n">have</span> <span class="n">never</span> <span class="n">been</span> <span class="n">better</span><span class="p">.</span>
<span class="n">Phase</span> <span class="mi">1</span> <span class="n">defused</span><span class="p">.</span> <span class="n">How</span> <span class="n">about</span> <span class="n">the</span> <span class="n">next</span> <span class="n">one</span><span class="o">?</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">8</span> <span class="mi">16</span> <span class="mi">32</span>
<span class="n">That</span><span class="err">'</span><span class="n">s</span> <span class="n">number</span> <span class="mi">2</span><span class="p">.</span>  <span class="n">Keep</span> <span class="n">going</span><span class="o">!</span>
<span class="mi">1</span> <span class="mi">311</span>
<span class="n">Halfway</span> <span class="n">there</span><span class="o">!</span>
<span class="mi">7</span> <span class="mi">0</span> <span class="n">DrEvil</span>
<span class="n">So</span> <span class="n">you</span> <span class="n">got</span> <span class="n">that</span> <span class="n">one</span><span class="p">.</span>  <span class="n">Try</span> <span class="n">this</span> <span class="n">one</span><span class="p">.</span>
<span class="mi">9</span><span class="o">?&gt;</span><span class="mi">567</span>
<span class="n">Good</span> <span class="n">work</span><span class="o">!</span>  <span class="n">On</span> <span class="n">to</span> <span class="n">the</span> <span class="n">next</span><span class="p">...</span>
<span class="mi">4</span> <span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">6</span> <span class="mi">5</span>
<span class="n">Curses</span><span class="p">,</span> <span class="n">you</span><span class="err">'</span><span class="n">ve</span> <span class="n">found</span> <span class="n">the</span> <span class="n">secret</span> <span class="n">phase</span><span class="o">!</span>
<span class="n">But</span> <span class="n">finding</span> <span class="n">it</span> <span class="n">and</span> <span class="n">solving</span> <span class="n">it</span> <span class="n">are</span> <span class="n">quite</span> <span class="n">different</span><span class="p">...</span>
<span class="mi">22</span>
<span class="n">Wow</span><span class="o">!</span> <span class="n">You</span><span class="err">'</span><span class="n">ve</span> <span class="n">defused</span> <span class="n">the</span> <span class="n">secret</span> <span class="n">stage</span><span class="o">!</span>
<span class="n">Congratulations</span><span class="o">!</span> <span class="n">You</span><span class="err">'</span><span class="n">ve</span> <span class="n">defused</span> <span class="n">the</span> <span class="n">bomb</span><span class="o">!</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Hooray, we did it!</p> <p>Through this series, we learned about what symbolic execution is, how path explosion is the main pitfall for symbolic execution, and various strategies for combating it. I personally learned a lot by doing this and felt much more comfortable with Angr than when I initially started out. I hope that you found this useful, and as always feedback and comments are greatly appreciated!</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <p class="mb-2">Related Posts:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/llama-3.1-technical-report-notes/">Notes on 'The Llama 3 Herd of Models'</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/setting-up-yuancon-controller-sound-voltex/">Playing Sound Voltex at Home: Setting Up Unnamed SDVX Clone with the Yuancon SDVX Controller</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/creating-trackback-requests/">Creating Trackback Requests for Static Sites</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/high-dimensional-analysis-of-m-estimators/">A Unified Framework for High-Dimensional Analysis of M-Estimators with Decomposable Regularizers: A Guided Walkthrough</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/cmu-steam-tunnels/">The CMU Steam Tunnels and Wean 9</a> </li> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'fanpu/fanpu.github.io',
        'data-repo-id': '',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Fan Pu Zeng. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Last updated: January 02, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script src="/assets/js/tooltips-setup.js?53023e960fbc64cccb90d32e9363de2b"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-S3VHEYH05S"></script> <script defer src="/assets/js/google-analytics-setup.js?12374742c4b1801ba82226e617af7e2d"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>