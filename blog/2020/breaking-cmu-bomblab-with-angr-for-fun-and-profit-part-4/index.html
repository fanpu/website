<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Breaking CMU's Bomblab with Angr for Fun and Profit - Part 4 | Fan Pu Zeng</title> <meta name="author" content="Fan Pu Zeng"> <meta name="description" content="Part 4 of cracking CMU's Bomblab using Angr! "> <meta name="keywords" content="fanpu, fan pu, fanpu zeng, fan pu zeng, zengfanpu, fanpuzeng, fzeng, CMU, cmu, carnegie mellon, cmu courses, school of computer science, scs, machine learning, computer science, ml, theory, courses, course reviews, CS, Jane Street"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="/assets/img/favicon_new.ico?426605099301e95aedae716cc398b951"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://fanpu.io/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-4/"> <meta name="twitter:site" content="@FanPu_Zeng"> <meta name="twitter:creator" content="@fanpu"> <meta name="og:title" content="Breaking CMU's Bomblab with Angr for Fun and Profit - Part 4"> <meta name="twitter:card" content="summary_large_image"> <meta name="og:image" content="https://fanpu.io/assets/img/posts/erie.webp"> <meta name="og:description" content="Part 4 of cracking CMU's Bomblab using Angr! "> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Fan Pu </span>Zeng</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/courses/">CMU Course Reviews</a> </li> <li class="nav-item "> <a class="nav-link" href="/cmu-online/">CMU Online</a> </li> <li class="nav-item "> <a class="nav-link" href="/summaries/">ML Paper Summaries</a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <div style="display:none"> $$ \newcommand{\bone}{\mathbf{1}} \newcommand{\bbeta}{\mathbf{\beta}} \newcommand{\bdelta}{\mathbf{\delta}} \newcommand{\bepsilon}{\mathbf{\epsilon}} \newcommand{\blambda}{\mathbf{\lambda}} \newcommand{\bomega}{\mathbf{\omega}} \newcommand{\bpi}{\mathbf{\pi}} \newcommand{\bphi}{\mathbf{\phi}} \newcommand{\bvphi}{\mathbf{\varphi}} \newcommand{\bpsi}{\mathbf{\psi}} \newcommand{\bsigma}{\mathbf{\sigma}} \newcommand{\btheta}{\mathbf{\theta}} \newcommand{\btau}{\mathbf{\tau}} \newcommand{\ba}{\mathbf{a}} \newcommand{\bb}{\mathbf{b}} \newcommand{\bc}{\mathbf{c}} \newcommand{\bd}{\mathbf{d}} \newcommand{\be}{\mathbf{e}} \newcommand{\boldf}{\mathbf{f}} \newcommand{\bg}{\mathbf{g}} \newcommand{\bh}{\mathbf{h}} \newcommand{\bi}{\mathbf{i}} \newcommand{\bj}{\mathbf{j}} \newcommand{\bk}{\mathbf{k}} \newcommand{\bell}{\mathbf{\ell}} \newcommand{\bm}{\mathbf{m}} \newcommand{\bn}{\mathbf{n}} \newcommand{\bo}{\mathbf{o}} \newcommand{\bp}{\mathbf{p}} \newcommand{\bq}{\mathbf{q}} \newcommand{\br}{\mathbf{r}} \newcommand{\bs}{\mathbf{s}} \newcommand{\bt}{\mathbf{t}} \newcommand{\bu}{\mathbf{u}} \newcommand{\bv}{\mathbf{v}} \newcommand{\bw}{\mathbf{w}} \newcommand{\bx}{\mathbf{x}} \newcommand{\by}{\mathbf{y}} \newcommand{\bz}{\mathbf{z}} \newcommand{\bA}{\mathbf{A}} \newcommand{\bB}{\mathbf{B}} \newcommand{\bC}{\mathbf{C}} \newcommand{\bD}{\mathbf{D}} \newcommand{\bE}{\mathbf{E}} \newcommand{\bF}{\mathbf{F}} \newcommand{\bG}{\mathbf{G}} \newcommand{\bH}{\mathbf{H}} \newcommand{\bI}{\mathbf{I}} \newcommand{\bJ}{\mathbf{J}} \newcommand{\bK}{\mathbf{K}} \newcommand{\bL}{\mathbf{L}} \newcommand{\bM}{\mathbf{M}} \newcommand{\bN}{\mathbf{N}} \newcommand{\bP}{\mathbf{P}} \newcommand{\bQ}{\mathbf{Q}} \newcommand{\bR}{\mathbf{R}} \newcommand{\bS}{\mathbf{S}} \newcommand{\bT}{\mathbf{T}} \newcommand{\bU}{\mathbf{U}} \newcommand{\bV}{\mathbf{V}} \newcommand{\bW}{\mathbf{W}} \newcommand{\bX}{\mathbf{X}} \newcommand{\bY}{\mathbf{Y}} \newcommand{\bZ}{\mathbf{Z}} \newcommand{\bsa}{\boldsymbol{a}} \newcommand{\bsb}{\boldsymbol{b}} \newcommand{\bsc}{\boldsymbol{c}} \newcommand{\bsd}{\boldsymbol{d}} \newcommand{\bse}{\boldsymbol{e}} \newcommand{\bsoldf}{\boldsymbol{f}} \newcommand{\bsg}{\boldsymbol{g}} \newcommand{\bsh}{\boldsymbol{h}} \newcommand{\bsi}{\boldsymbol{i}} \newcommand{\bsj}{\boldsymbol{j}} \newcommand{\bsk}{\boldsymbol{k}} \newcommand{\bsell}{\boldsymbol{\ell}} \newcommand{\bsm}{\boldsymbol{m}} \newcommand{\bsn}{\boldsymbol{n}} \newcommand{\bso}{\boldsymbol{o}} \newcommand{\bsp}{\boldsymbol{p}} \newcommand{\bsq}{\boldsymbol{q}} \newcommand{\bsr}{\boldsymbol{r}} \newcommand{\bss}{\boldsymbol{s}} \newcommand{\bst}{\boldsymbol{t}} \newcommand{\bsu}{\boldsymbol{u}} \newcommand{\bsv}{\boldsymbol{v}} \newcommand{\bsw}{\boldsymbol{w}} \newcommand{\bsx}{\boldsymbol{x}} \newcommand{\bsy}{\boldsymbol{y}} \newcommand{\bsz}{\boldsymbol{z}} \newcommand{\bsA}{\boldsymbol{A}} \newcommand{\bsB}{\boldsymbol{B}} \newcommand{\bsC}{\boldsymbol{C}} \newcommand{\bsD}{\boldsymbol{D}} \newcommand{\bsE}{\boldsymbol{E}} \newcommand{\bsF}{\boldsymbol{F}} \newcommand{\bsG}{\boldsymbol{G}} \newcommand{\bsH}{\boldsymbol{H}} \newcommand{\bsI}{\boldsymbol{I}} \newcommand{\bsJ}{\boldsymbol{J}} \newcommand{\bsK}{\boldsymbol{K}} \newcommand{\bsL}{\boldsymbol{L}} \newcommand{\bsM}{\boldsymbol{M}} \newcommand{\bsN}{\boldsymbol{N}} \newcommand{\bsP}{\boldsymbol{P}} \newcommand{\bsQ}{\boldsymbol{Q}} \newcommand{\bsR}{\boldsymbol{R}} \newcommand{\bsS}{\boldsymbol{S}} \newcommand{\bsT}{\boldsymbol{T}} \newcommand{\bsU}{\boldsymbol{U}} \newcommand{\bsV}{\boldsymbol{V}} \newcommand{\bsW}{\boldsymbol{W}} \newcommand{\bsX}{\boldsymbol{X}} \newcommand{\bsY}{\boldsymbol{Y}} \newcommand{\bsZ}{\boldsymbol{Z}} \newcommand{\calA}{\mathcal{A}} \newcommand{\calB}{\mathcal{B}} \newcommand{\calC}{\mathcal{C}} \newcommand{\calD}{\mathcal{D}} \newcommand{\calE}{\mathcal{E}} \newcommand{\calF}{\mathcal{F}} \newcommand{\calG}{\mathcal{G}} \newcommand{\calH}{\mathcal{H}} \newcommand{\calI}{\mathcal{I}} \newcommand{\calJ}{\mathcal{J}} \newcommand{\calK}{\mathcal{K}} \newcommand{\calL}{\mathcal{L}} \newcommand{\calM}{\mathcal{M}} \newcommand{\calN}{\mathcal{N}} \newcommand{\calO}{\mathcal{O}} \newcommand{\calP}{\mathcal{P}} \newcommand{\calQ}{\mathcal{Q}} \newcommand{\calR}{\mathcal{R}} \newcommand{\calS}{\mathcal{S}} \newcommand{\calT}{\mathcal{T}} \newcommand{\calU}{\mathcal{U}} \newcommand{\calV}{\mathcal{V}} \newcommand{\calW}{\mathcal{W}} \newcommand{\calX}{\mathcal{X}} \newcommand{\calY}{\mathcal{Y}} \newcommand{\calZ}{\mathcal{Z}} \newcommand{\R}{\mathbb{R}} \newcommand{\C}{\mathbb{C}} \newcommand{\N}{\mathbb{N}} \newcommand{\Z}{\mathbb{Z}} \newcommand{\F}{\mathbb{F}} \newcommand{\Q}{\mathbb{Q}} \DeclareMathOperator*{\argmax}{arg\,max} \DeclareMathOperator*{\argmin}{arg\,min} \newcommand{\nnz}[1]{\mbox{nnz}(#1)} \newcommand{\dotprod}[2]{\langle #1, #2 \rangle} \newcommand{\ignore}[1]{} \let\Pr\relax \DeclareMathOperator*{\Pr}{\mathbf{Pr}} \newcommand{\E}{\mathbb{E}} \DeclareMathOperator*{\Ex}{\mathbf{E}} \DeclareMathOperator*{\Var}{\mathbf{Var}} \DeclareMathOperator*{\Cov}{\mathbf{Cov}} \DeclareMathOperator*{\stddev}{\mathbf{stddev}} \DeclareMathOperator*{\avg}{avg} \DeclareMathOperator{\poly}{poly} \DeclareMathOperator{\polylog}{polylog} \DeclareMathOperator{\size}{size} \DeclareMathOperator{\sgn}{sgn} \DeclareMathOperator{\dist}{dist} \DeclareMathOperator{\vol}{vol} \DeclareMathOperator{\spn}{span} \DeclareMathOperator{\supp}{supp} \DeclareMathOperator{\tr}{tr} \DeclareMathOperator{\Tr}{Tr} \DeclareMathOperator{\codim}{codim} \DeclareMathOperator{\diag}{diag} \newcommand{\PTIME}{\mathsf{P}} \newcommand{\LOGSPACE}{\mathsf{L}} \newcommand{\ZPP}{\mathsf{ZPP}} \newcommand{\RP}{\mathsf{RP}} \newcommand{\BPP}{\mathsf{BPP}} \newcommand{\P}{\mathsf{P}} \newcommand{\NP}{\mathsf{NP}} \newcommand{\TC}{\mathsf{TC}} \newcommand{\AC}{\mathsf{AC}} \newcommand{\SC}{\mathsf{SC}} \newcommand{\SZK}{\mathsf{SZK}} \newcommand{\AM}{\mathsf{AM}} \newcommand{\IP}{\mathsf{IP}} \newcommand{\PSPACE}{\mathsf{PSPACE}} \newcommand{\EXP}{\mathsf{EXP}} \newcommand{\MIP}{\mathsf{MIP}} \newcommand{\NEXP}{\mathsf{NEXP}} \newcommand{\BQP}{\mathsf{BQP}} \newcommand{\distP}{\mathsf{dist\textbf{P}}} \newcommand{\distNP}{\mathsf{dist\textbf{NP}}} \newcommand{\eps}{\epsilon} \newcommand{\lam}{\lambda} \newcommand{\dleta}{\delta} \newcommand{\simga}{\sigma} \newcommand{\vphi}{\varphi} \newcommand{\la}{\langle} \newcommand{\ra}{\rangle} \newcommand{\wt}[1]{\widetilde{#1}} \newcommand{\wh}[1]{\widehat{#1}} \newcommand{\ol}[1]{\overline{#1}} \newcommand{\ul}[1]{\underline{#1}} \newcommand{\ot}{\otimes} \newcommand{\zo}{\{0,1\}} \newcommand{\co}{:} %\newcommand{\co}{\colon} \newcommand{\bdry}{\partial} \newcommand{\grad}{\nabla} \newcommand{\transp}{^\intercal} \newcommand{\inv}{^{-1}} \newcommand{\symmdiff}{\triangle} \newcommand{\symdiff}{\symmdiff} \newcommand{\half}{\tfrac{1}{2}} \newcommand{\bbone}{\mathbbm 1} \newcommand{\Id}{\bbone} \newcommand{\SAT}{\mathsf{SAT}} \newcommand{\bcalG}{\boldsymbol{\calG}} \newcommand{\calbG}{\bcalG} \newcommand{\bcalX}{\boldsymbol{\calX}} \newcommand{\calbX}{\bcalX} \newcommand{\bcalY}{\boldsymbol{\calY}} \newcommand{\calbY}{\bcalY} \newcommand{\bcalZ}{\boldsymbol{\calZ}} \newcommand{\calbZ}{\bcalZ} $$ </div> <header class="post-header"> <h1 class="post-title">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 4</h1> <p class="post-meta">August 2, 2020• fanpu</p> <p class="post-tags"> <a href="/blog/2020"> <i class="fas fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/rev"> <i class="fas fa-hashtag fa-sm"></i> rev</a>   <a href="/blog/tag/ctf"> <i class="fas fa-hashtag fa-sm"></i> ctf</a>   </p> </header> <figure> <picture> <img src="/assets/img/posts/erie.webp" class="preview z-depth-1 rounded center" width="100%" height="450px" alt="post.cover" style="object-fit: cover" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Lake Erie, Erie, Pennsylvania, USA </div> <article class="post-content"> <div id="markdown-content"> <p>Welcome back to Part 4 of cracking CMU’s Bomblab using Angr! If you just stumbled upon this, I would recommend starting with part 1 <a href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-1/">here</a>.</p> <h3 id="phase-4">Phase 4</h3> <p>Let’s disassemble Phase 4:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">disas</span> <span class="n">phase_4</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="n">phase_4</span><span class="o">:</span>
   <span class="mh">0x000000000040100c</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x18</span>
   <span class="mh">0x0000000000401010</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rcx</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0xc</span><span class="p">]</span>
   <span class="mh">0x0000000000401015</span> <span class="o">&lt;+</span><span class="mi">9</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">rdx</span><span class="p">,[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x000000000040101a</span> <span class="o">&lt;+</span><span class="mi">14</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="mh">0x4025cf</span>
   <span class="mh">0x000000000040101f</span> <span class="o">&lt;+</span><span class="mi">19</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000401024</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x400bf0</span> <span class="o">&lt;</span><span class="n">__isoc99_sscanf</span><span class="err">@</span><span class="n">plt</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401029</span> <span class="o">&lt;+</span><span class="mi">29</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x2</span>
   <span class="mh">0x000000000040102c</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x401035</span> <span class="o">&lt;</span><span class="n">phase_4</span><span class="o">+</span><span class="mi">41</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040102e</span> <span class="o">&lt;+</span><span class="mi">34</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">],</span><span class="mh">0xe</span>
   <span class="mh">0x0000000000401033</span> <span class="o">&lt;+</span><span class="mi">39</span><span class="o">&gt;:</span>	<span class="n">jbe</span>    <span class="mh">0x40103a</span> <span class="o">&lt;</span><span class="n">phase_4</span><span class="o">+</span><span class="mi">46</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401035</span> <span class="o">&lt;+</span><span class="mi">41</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040103a</span> <span class="o">&lt;+</span><span class="mi">46</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="mh">0xe</span>
   <span class="mh">0x000000000040103f</span> <span class="o">&lt;+</span><span class="mi">51</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">esi</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000401044</span> <span class="o">&lt;+</span><span class="mi">56</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">edi</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span><span class="p">]</span>
   <span class="mh">0x0000000000401048</span> <span class="o">&lt;+</span><span class="mi">60</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x400fce</span> <span class="o">&lt;</span><span class="n">func4</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040104d</span> <span class="o">&lt;+</span><span class="mi">65</span><span class="o">&gt;:</span>	<span class="n">test</span>   <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>
   <span class="mh">0x000000000040104f</span> <span class="o">&lt;+</span><span class="mi">67</span><span class="o">&gt;:</span>	<span class="n">jne</span>    <span class="mh">0x401058</span> <span class="o">&lt;</span><span class="n">phase_4</span><span class="o">+</span><span class="mi">76</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401051</span> <span class="o">&lt;+</span><span class="mi">69</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">rsp</span><span class="o">+</span><span class="mh">0xc</span><span class="p">],</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000401056</span> <span class="o">&lt;+</span><span class="mi">74</span><span class="o">&gt;:</span>	<span class="n">je</span>     <span class="mh">0x40105d</span> <span class="o">&lt;</span><span class="n">phase_4</span><span class="o">+</span><span class="mi">81</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401058</span> <span class="o">&lt;+</span><span class="mi">76</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x40143a</span> <span class="o">&lt;</span><span class="n">explode_bomb</span><span class="o">&gt;</span>
   <span class="mh">0x000000000040105d</span> <span class="o">&lt;+</span><span class="mi">81</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x18</span>
   <span class="mh">0x0000000000401061</span> <span class="o">&lt;+</span><span class="mi">85</span><span class="o">&gt;:</span>	<span class="n">ret</span>    
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>The <code class="language-plaintext highlighter-rouge">sscanf</code> and the call to <code class="language-plaintext highlighter-rouge">func4</code> is interesting. Let’s check out <code class="language-plaintext highlighter-rouge">func4</code> first:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">disas</span> <span class="n">func4</span>
<span class="n">Dump</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">code</span> <span class="k">for</span> <span class="n">function</span> <span class="n">func4</span><span class="o">:</span>
   <span class="mh">0x0000000000400fce</span> <span class="o">&lt;+</span><span class="mi">0</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x8</span>
   <span class="mh">0x0000000000400fd2</span> <span class="o">&lt;+</span><span class="mi">4</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">edx</span>
   <span class="mh">0x0000000000400fd4</span> <span class="o">&lt;+</span><span class="mi">6</span><span class="o">&gt;:</span>	<span class="n">sub</span>    <span class="n">eax</span><span class="p">,</span><span class="n">esi</span>
   <span class="mh">0x0000000000400fd6</span> <span class="o">&lt;+</span><span class="mi">8</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">eax</span>
   <span class="mh">0x0000000000400fd8</span> <span class="o">&lt;+</span><span class="mi">10</span><span class="o">&gt;:</span>	<span class="n">shr</span>    <span class="n">ecx</span><span class="p">,</span><span class="mh">0x1f</span>
   <span class="mh">0x0000000000400fdb</span> <span class="o">&lt;+</span><span class="mi">13</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">eax</span><span class="p">,</span><span class="n">ecx</span>
   <span class="mh">0x0000000000400fdd</span> <span class="o">&lt;+</span><span class="mi">15</span><span class="o">&gt;:</span>	<span class="n">sar</span>    <span class="n">eax</span><span class="p">,</span><span class="mi">1</span>
   <span class="mh">0x0000000000400fdf</span> <span class="o">&lt;+</span><span class="mi">17</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">ecx</span><span class="p">,[</span><span class="n">rax</span><span class="o">+</span><span class="n">rsi</span><span class="o">*</span><span class="mi">1</span><span class="p">]</span>
   <span class="mh">0x0000000000400fe2</span> <span class="o">&lt;+</span><span class="mi">20</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">edi</span>
   <span class="mh">0x0000000000400fe4</span> <span class="o">&lt;+</span><span class="mi">22</span><span class="o">&gt;:</span>	<span class="n">jle</span>    <span class="mh">0x400ff2</span> <span class="o">&lt;</span><span class="n">func4</span><span class="o">+</span><span class="mi">36</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400fe6</span> <span class="o">&lt;+</span><span class="mi">24</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">edx</span><span class="p">,[</span><span class="n">rcx</span><span class="o">-</span><span class="mh">0x1</span><span class="p">]</span>
   <span class="mh">0x0000000000400fe9</span> <span class="o">&lt;+</span><span class="mi">27</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x400fce</span> <span class="o">&lt;</span><span class="n">func4</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400fee</span> <span class="o">&lt;+</span><span class="mi">32</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>
   <span class="mh">0x0000000000400ff0</span> <span class="o">&lt;+</span><span class="mi">34</span><span class="o">&gt;:</span>	<span class="n">jmp</span>    <span class="mh">0x401007</span> <span class="o">&lt;</span><span class="n">func4</span><span class="o">+</span><span class="mi">57</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400ff2</span> <span class="o">&lt;+</span><span class="mi">36</span><span class="o">&gt;:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="mh">0x0000000000400ff7</span> <span class="o">&lt;+</span><span class="mi">41</span><span class="o">&gt;:</span>	<span class="n">cmp</span>    <span class="n">ecx</span><span class="p">,</span><span class="n">edi</span>
   <span class="mh">0x0000000000400ff9</span> <span class="o">&lt;+</span><span class="mi">43</span><span class="o">&gt;:</span>	<span class="n">jge</span>    <span class="mh">0x401007</span> <span class="o">&lt;</span><span class="n">func4</span><span class="o">+</span><span class="mi">57</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000400ffb</span> <span class="o">&lt;+</span><span class="mi">45</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">esi</span><span class="p">,[</span><span class="n">rcx</span><span class="o">+</span><span class="mh">0x1</span><span class="p">]</span>
   <span class="mh">0x0000000000400ffe</span> <span class="o">&lt;+</span><span class="mi">48</span><span class="o">&gt;:</span>	<span class="n">call</span>   <span class="mh">0x400fce</span> <span class="o">&lt;</span><span class="n">func4</span><span class="o">&gt;</span>
   <span class="mh">0x0000000000401003</span> <span class="o">&lt;+</span><span class="mi">53</span><span class="o">&gt;:</span>	<span class="n">lea</span>    <span class="n">eax</span><span class="p">,[</span><span class="n">rax</span><span class="o">+</span><span class="n">rax</span><span class="o">*</span><span class="mi">1</span><span class="o">+</span><span class="mh">0x1</span><span class="p">]</span>
   <span class="mh">0x0000000000401007</span> <span class="o">&lt;+</span><span class="mi">57</span><span class="o">&gt;:</span>	<span class="n">add</span>    <span class="n">rsp</span><span class="p">,</span><span class="mh">0x8</span>
   <span class="mh">0x000000000040100b</span> <span class="o">&lt;+</span><span class="mi">61</span><span class="o">&gt;:</span>	<span class="n">ret</span>    
<span class="n">End</span> <span class="n">of</span> <span class="n">assembler</span> <span class="n">dump</span><span class="p">.</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>I was so happy when I saw this. There is no input expected at all, and everything is self contained, so we could basically ignore this whole function.</p> <p>Let’s see the format string for <code class="language-plaintext highlighter-rouge">sscanf</code> again to see what’s expected of us:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td> <td class="code"><pre><span class="n">gef</span><span class="err">➤</span>  <span class="n">x</span><span class="o">/</span><span class="n">s</span> <span class="mh">0x4025cf</span>
<span class="mh">0x4025cf</span><span class="o">:</span>	<span class="s">"%d %d"</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Wow, another 2 integers? They are surely making our life very easy. In fact, even the stack offsets of the arguments that <code class="language-plaintext highlighter-rouge">sscanf</code> extracts to are the same as in Phase 3, of being <code class="language-plaintext highlighter-rouge">0x8</code> and <code class="language-plaintext highlighter-rouge">0xc</code> from the stack base.</p> <p>We can literally re-use the same exploit script as Phase 3, except we need to change the start address and the find address accordingly.</p> <h3 id="full-solution-script">Full Solution Script</h3> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td> <td class="code"><pre><span class="kn">import</span> <span class="n">angr</span>
<span class="kn">import</span> <span class="n">claripy</span>
<span class="kn">import</span> <span class="n">sys</span>

<span class="k">def</span> <span class="nf">phase_4</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span>
    <span class="n">path_to_binary</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">angr</span><span class="p">.</span><span class="nc">Project</span><span class="p">(</span><span class="n">path_to_binary</span><span class="p">)</span>

    <span class="c1"># Tell Angr where to start executing 
</span>    <span class="n">start_addr</span> <span class="o">=</span> <span class="mh">0x00401029</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">blank_state</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="n">start_addr</span><span class="p">)</span>

    <span class="n">num_12</span> <span class="o">=</span> <span class="n">claripy</span><span class="p">.</span><span class="nc">BVS</span><span class="p">(</span><span class="sh">'</span><span class="s">num_12</span><span class="sh">'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>

    <span class="n">initial_state</span><span class="p">.</span><span class="nf">stack_push</span><span class="p">(</span><span class="n">num_12</span><span class="p">)</span>

    <span class="n">padding_length_in_bytes</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">initial_state</span><span class="p">.</span><span class="n">regs</span><span class="p">.</span><span class="n">rsp</span> <span class="o">-=</span> <span class="n">padding_length_in_bytes</span>

    
    <span class="c1"># Create a simulation manager initialized with the starting state
</span>    <span class="n">simulation</span> <span class="o">=</span> <span class="n">project</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="nf">simgr</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>

    <span class="n">success_addr</span> <span class="o">=</span> <span class="mh">0x00401061</span> <span class="c1"># right before ret
</span>    <span class="n">explode_addr</span> <span class="o">=</span> <span class="mh">0x0040143a</span> <span class="c1"># explode_bomb
</span>
    <span class="n">simulation</span><span class="p">.</span><span class="nf">explore</span><span class="p">(</span><span class="n">find</span><span class="o">=</span><span class="n">success_addr</span><span class="p">,</span> <span class="n">avoid</span><span class="o">=</span><span class="n">explode_addr</span><span class="p">)</span>

    <span class="c1"># Check that we have found a solution
</span>    <span class="k">if</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">:</span>
        <span class="n">solution_state</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">.</span><span class="n">found</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">num_12_sol</span> <span class="o">=</span> <span class="n">solution_state</span><span class="p">.</span><span class="n">se</span><span class="p">.</span><span class="nf">eval</span><span class="p">(</span><span class="n">num_12</span><span class="p">,</span> <span class="n">cast_to</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">unpack_ints</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">lower_32_mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="nf">return </span><span class="p">(</span><span class="n">n</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">lower_32_mask</span><span class="p">)</span>

        <span class="n">num_1_sol</span><span class="p">,</span> <span class="n">num_2_sol</span> <span class="o">=</span> <span class="nf">unpack_ints</span><span class="p">(</span><span class="n">num_12_sol</span><span class="p">)</span>

        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">num_1_sol</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">num_2_sol</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">Exception</span><span class="p">(</span><span class="sh">'</span><span class="s">Could not find the solution</span><span class="sh">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">phase_4</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>If we run it, we get the following:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td> <td class="code"><pre><span class="err">$</span> <span class="n">python</span> <span class="n">solve</span><span class="p">.</span><span class="n">py</span> <span class="n">bomb</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">080</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">The</span> <span class="n">program</span> <span class="n">is</span> <span class="n">accessing</span> <span class="n">memory</span> <span class="n">or</span> <span class="n">registers</span> <span class="n">with</span> <span class="n">an</span> <span class="n">unspecified</span> <span class="n">value</span><span class="p">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">indicate</span> <span class="n">unwanted</span> <span class="n">behavior</span><span class="p">.</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">081</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">angr</span> <span class="n">will</span> <span class="n">cope</span> <span class="n">with</span> <span class="n">this</span> <span class="n">by</span> <span class="n">generating</span> <span class="n">an</span> <span class="n">unconstrained</span> <span class="n">symbolic</span> <span class="n">variable</span> <span class="n">and</span> <span class="n">continuing</span><span class="p">.</span> <span class="n">You</span> <span class="n">can</span> <span class="n">resolve</span> <span class="n">this</span> <span class="n">by</span><span class="o">:</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">081</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">1</span><span class="p">)</span> <span class="n">setting</span> <span class="n">a</span> <span class="n">value</span> <span class="n">to</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">state</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">081</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">2</span><span class="p">)</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">state</span> <span class="n">option</span> <span class="n">ZERO_FILL_UNCONSTRAINED_</span><span class="p">{</span><span class="n">MEMORY</span><span class="p">,</span><span class="n">REGISTERS</span><span class="p">},</span> <span class="n">to</span> <span class="n">make</span> <span class="n">unknown</span> <span class="n">regions</span> <span class="n">hold</span> <span class="n">null</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">081</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="mi">3</span><span class="p">)</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">state</span> <span class="n">option</span> <span class="n">SYMBOL_FILL_UNCONSTRAINED_</span><span class="p">{</span><span class="n">MEMORY_REGISTERS</span><span class="p">},</span> <span class="n">to</span> <span class="n">suppress</span> <span class="n">these</span> <span class="n">messages</span><span class="p">.</span>
<span class="n">WARNING</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">081</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">state_plugins</span><span class="p">.</span><span class="n">symbolic_memory</span> <span class="o">|</span> <span class="n">Filling</span> <span class="k">register</span> <span class="n">rax</span> <span class="n">with</span> <span class="mi">8</span> <span class="n">unconstrained</span> <span class="n">bytes</span> <span class="n">referenced</span> <span class="n">from</span> <span class="mh">0x401029</span> <span class="p">(</span><span class="n">phase_4</span><span class="o">+</span><span class="mh">0x1d</span> <span class="n">in</span> <span class="n">bomb</span> <span class="p">(</span><span class="mh">0x401029</span><span class="p">))</span>
<span class="n">CRITICAL</span> <span class="o">|</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mo">02</span> <span class="mi">19</span><span class="o">:</span><span class="mi">55</span><span class="o">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">906</span> <span class="o">|</span> <span class="n">angr</span><span class="p">.</span><span class="n">sim_state</span> <span class="o">|</span> <span class="n">The</span> <span class="n">name</span> <span class="n">state</span><span class="p">.</span><span class="n">se</span> <span class="n">is</span> <span class="n">deprecated</span><span class="p">;</span> <span class="n">please</span> <span class="n">use</span> <span class="n">state</span><span class="p">.</span><span class="n">solver</span><span class="p">.</span>
<span class="mi">7</span> <span class="mi">0</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Trying it on the bomb itself:</p> <figure class="highlight"><pre><code class="language-c" data-lang="c"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td> <td class="code"><pre><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">bomb</span>
<span class="n">Welcome</span> <span class="n">to</span> <span class="n">my</span> <span class="n">fiendish</span> <span class="n">little</span> <span class="n">bomb</span><span class="p">.</span> <span class="n">You</span> <span class="n">have</span> <span class="mi">6</span> <span class="n">phases</span> <span class="n">with</span>
<span class="n">which</span> <span class="n">to</span> <span class="n">blow</span> <span class="n">yourself</span> <span class="n">up</span><span class="p">.</span> <span class="n">Have</span> <span class="n">a</span> <span class="n">nice</span> <span class="n">day</span><span class="o">!</span>
<span class="n">Border</span> <span class="n">relations</span> <span class="n">with</span> <span class="n">Canada</span> <span class="n">have</span> <span class="n">never</span> <span class="n">been</span> <span class="n">better</span><span class="p">.</span>
<span class="n">Phase</span> <span class="mi">1</span> <span class="n">defused</span><span class="p">.</span> <span class="n">How</span> <span class="n">about</span> <span class="n">the</span> <span class="n">next</span> <span class="n">one</span><span class="o">?</span>
<span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">8</span> <span class="mi">16</span> <span class="mi">32</span>
<span class="n">That</span><span class="err">'</span><span class="n">s</span> <span class="n">number</span> <span class="mi">2</span><span class="p">.</span>  <span class="n">Keep</span> <span class="n">going</span><span class="o">!</span>
<span class="mi">1</span> <span class="mi">311</span>
<span class="n">Halfway</span> <span class="n">there</span><span class="o">!</span>
<span class="mi">7</span> <span class="mi">0</span>
<span class="n">So</span> <span class="n">you</span> <span class="n">got</span> <span class="n">that</span> <span class="n">one</span><span class="p">.</span>  <span class="n">Try</span> <span class="n">this</span> <span class="n">one</span><span class="p">.</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Easy peasy lemon squeezy! This took basically no effort at all. You can continue on to Part 5 <a href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-5/">here</a>.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <p class="mb-2">Related Posts:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-3/">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 3</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-1/">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 1</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-6/">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 6</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-7/">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 7</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2020/breaking-cmu-bomblab-with-angr-for-fun-and-profit-part-5/">Breaking CMU's Bomblab with Angr for Fun and Profit - Part 5</a> </li> <div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"fanpu/website","data-repo-id":"R_kgDOIpOodA","data-category":"General","data-category-id":"DIC_kwDOIpOodM4CTKDC","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Fan Pu Zeng. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Last updated: January 01, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script type="text/javascript">$(function(){$('[data-toggle="tooltip"]').tooltip()});</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={loader:{load:["[tex]/mathtools"]},tex:{packages:{"[+]":["mathtools","ams"]},tags:"ams"},options:{renderActions:{addMenu:[]}}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-S3VHEYH05S"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S3VHEYH05S");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>