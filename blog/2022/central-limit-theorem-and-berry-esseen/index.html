<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>A Concise Proof of the Central Limit Theorem, and Its Actually Useful Version, the Berry-Esseen Theorem | Fan Pu Zeng</title> <meta name="author" content="Fan Pu Zeng"> <meta name="description" content="The Central Limit Theorem is widely used in statistics and machine learning, as it allows us to assume that given enough samples, the mean of the samples will follow a normal distribution. This holds even if the samples come from a distribution that is not normally distributed. In this post, we prove the Central Limit Theorem, and then take a look at the Berry-Esseen Theorem, which actually provides a quantitative bound on the convergence of the distribution and can therefore be actually used in deriving theoretical bounds. "> <meta name="keywords" content="fanpu, fanpu-zeng, fzeng, zengfanpu, fan-pu, zeng-fan-pu, CMU, carnegie-mellon, machine-learning, ml, theory, courses, course-reviews, computer-science, CS, SCS"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon_new.ico%EF%B8%8F"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://fanpu.io/blog/2022/central-limit-theorem-and-berry-esseen/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Fan Pu </span>Zeng</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/courses/">cmu course reviews</a> </li> <li class="nav-item "> <a class="nav-link" href="/cmu-online/">cmu online</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div style="display:none"> $$ \DeclareMathOperator*{\argmax}{arg\,max} \DeclareMathOperator*{\argmin}{arg\,min} \newcommand{\nnz}[1]{\mbox{nnz}(#1)} \newcommand{\dotprod}[2]{\langle #1, #2 \rangle} \DeclareMathOperator*{\Pr}{\mathbf{Pr}} \DeclareMathOperator*{\E}{\mathbf{E}} \DeclareMathOperator*{\Ex}{\mathbf{E}} \DeclareMathOperator*{\Var}{\mathbf{Var}} \DeclareMathOperator*{\Cov}{\mathbf{Cov}} \DeclareMathOperator*{\stddev}{\mathbf{stddev}} \DeclareMathOperator{\littlesum} \DeclareMathOperator{\littleprod} \DeclareMathOperator*{\avg}{avg} % environments \declaretheorem[numberwithin=section]{theorem} \declaretheorem[sibling=theorem]{lemma} \declaretheorem[sibling=theorem]{claim} \declaretheorem[sibling=theorem]{proposition} \declaretheorem[sibling=theorem]{fact} \declaretheorem[sibling=theorem]{corollary} \declaretheorem[sibling=theorem]{conjecture} \declaretheorem[sibling=theorem]{question} \declaretheorem[sibling=theorem]{answer} \declaretheorem[sibling=theorem]{solution} \declaretheorem[sibling=theorem]{hypothesis} \declaretheorem[sibling=theorem]{exercise} \theoremstyle{definition} \declaretheorem[sibling=theorem]{definition} \declaretheorem[sibling=theorem]{remark} \declaretheorem[sibling=theorem]{notation} \declaretheorem[sibling=theorem]{observation} \declaretheorem[sibling=theorem]{example} \newcommand{\ignore}[1]{} % probability type operators \let\Pr\relax \DeclareMathOperator*{\Pr}{\mathbf{Pr}} \DeclareMathOperator*{\E}{\mathbf{E}} \DeclareMathOperator*{\Ex}{\mathbf{E}} \DeclareMathOperator*{\Var}{\mathbf{Var}} \DeclareMathOperator*{\Cov}{\mathbf{Cov}} \DeclareMathOperator*{\stddev}{\mathbf{stddev}} \DeclareMathOperator{\littlesum} \DeclareMathOperator{\littleprod} \DeclareMathOperator*{\avg}{avg} % math terms \DeclareMathOperator{\poly}{poly} \DeclareMathOperator{\polylog}{polylog} \DeclareMathOperator{\size}{size} \DeclareMathOperator{\sgn}{sgn} \DeclareMathOperator{\dist}{dist} \DeclareMathOperator{\vol}{vol} \DeclareMathOperator{\spn}{span} \DeclareMathOperator{\supp}{supp} \DeclareMathOperator{\tr}{tr} \DeclareMathOperator{\Tr}{Tr} \DeclareMathOperator{\codim}{codim} \DeclareMathOperator{\diag}{diag} % number systems \newcommand{\R}{\mathbb R} \newcommand{\C}{\mathbb C} \newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\F}{\mathbb F} \newcommand{\Q}{\mathbb Q} % complexity classes \newcommand{\PTIME}{\mathsf{P}} \newcommand{\LOGSPACE}{\mathsf{L}} \newcommand{\ZPP}{\mathsf{ZPP}} \newcommand{\RP}{\mathsf{RP}} \newcommand{\BPP}{\mathsf{BPP}} \newcommand{\P}{\mathsf{P}} \newcommand{\NP}{\mathsf{NP}} \newcommand{\TC}{\mathsf{TC}} \newcommand{\AC}{\mathsf{AC}} \newcommand{\SC}{\mathsf{SC}} \newcommand{\SZK}{\mathsf{SZK}} \newcommand{\AM}{\mathsf{AM}} \newcommand{\IP}{\mathsf{IP}} \newcommand{\PSPACE}{\mathsf{PSPACE}} \newcommand{\EXP}{\mathsf{EXP}} \newcommand{\MIP}{\mathsf{MIP}} \newcommand{\NEXP}{\mathsf{NEXP}} \newcommand{\BQP}{\mathsf{BQP}} \newcommand{\distP}{\mathsf{dist\textbf{P}}} \newcommand{\distNP}{\mathsf{dist\textbf{NP}}} % short forms \newcommand{\eps}{\epsilon} \newcommand{\lam}{\lambda} \newcommand{\dleta}{\delta} \newcommand{\simga}{\sigma} \newcommand{\vphi}{\varphi} \newcommand{\la}{\langle} \newcommand{\ra}{\rangle} \newcommand{\wt}[1]{\widetilde{#1}} \newcommand{\wh}[1]{\widehat{#1}} \newcommand{\ol}[1]{\overline{#1}} \newcommand{\ul}[1]{\underline{#1}} \newcommand{\ot}{\otimes} \newcommand{\zo}{\{0,1\}} \newcommand{\co}{:} %\newcommand{\co}{\colon} \newcommand{\bdry}{\partial} \newcommand{\grad}{\nabla} \newcommand{\transp}{^\intercal} \newcommand{\inv}{^{-1}} \newcommand{\symmdiff}{\triangle} \newcommand{\symdiff}{\symmdiff} \newcommand{\half}{\tfrac{1}{2}} \newcommand{\bbone}{\mathbbm 1} \newcommand{\Id}{\bbone} \newcommand{\SAT}{\mathsf{SAT}} % calligraphic letters \newcommand{\calA}{\mathcal{A}} \newcommand{\calB}{\mathcal{B}} \newcommand{\calC}{\mathcal{C}} \newcommand{\calD}{\mathcal{D}} \newcommand{\calE}{\mathcal{E}} \newcommand{\calF}{\mathcal{F}} \newcommand{\calG}{\mathcal{G}} \newcommand{\calH}{\mathcal{H}} \newcommand{\calI}{\mathcal{I}} \newcommand{\calJ}{\mathcal{J}} \newcommand{\calK}{\mathcal{K}} \newcommand{\calL}{\mathcal{L}} \newcommand{\calM}{\mathcal{M}} \newcommand{\calN}{\mathcal{N}} \newcommand{\calO}{\mathcal{O}} \newcommand{\calP}{\mathcal{P}} \newcommand{\calQ}{\mathcal{Q}} \newcommand{\calR}{\mathcal{R}} \newcommand{\calS}{\mathcal{S}} \newcommand{\calT}{\mathcal{T}} \newcommand{\calU}{\mathcal{U}} \newcommand{\calV}{\mathcal{V}} \newcommand{\calW}{\mathcal{W}} \newcommand{\calX}{\mathcal{X}} \newcommand{\calY}{\mathcal{Y}} \newcommand{\calZ}{\mathcal{Z}} % bold \newcommand{\bone}{\boldsymbol{1}} \newcommand{\bbeta}{\boldsymbol{\beta}} \newcommand{\bdelta}{\boldsymbol{\delta}} \newcommand{\bepsilon}{\boldsymbol{\epsilon}} \newcommand{\blambda}{\boldsymbol{\lambda}} \newcommand{\bomega}{\boldsymbol{\omega}} \newcommand{\bpi}{\boldsymbol{\pi}} \newcommand{\bphi}{\boldsymbol{\phi}} \newcommand{\bvphi}{\boldsymbol{\varphi}} \newcommand{\bpsi}{\boldsymbol{\psi}} \newcommand{\bsigma}{\boldsymbol{\sigma}} \newcommand{\btheta}{\boldsymbol{\theta}} \newcommand{\btau}{\boldsymbol{\tau}} \newcommand{\ba}{\boldsymbol{a}} \newcommand{\bb}{\boldsymbol{b}} \newcommand{\bc}{\boldsymbol{c}} \newcommand{\bd}{\boldsymbol{d}} \newcommand{\be}{\boldsymbol{e}} \newcommand{\boldf}{\boldsymbol{f}} \newcommand{\bg}{\boldsymbol{g}} \newcommand{\bh}{\boldsymbol{h}} \newcommand{\bi}{\boldsymbol{i}} \newcommand{\bj}{\boldsymbol{j}} \newcommand{\bk}{\boldsymbol{k}} \newcommand{\bell}{\boldsymbol{\ell}} \newcommand{\bm}{\boldsymbol{m}} \newcommand{\bn}{\boldsymbol{n}} \newcommand{\bo}{\boldsymbol{o}} \newcommand{\bp}{\boldsymbol{p}} \newcommand{\bq}{\boldsymbol{q}} \newcommand{\br}{\boldsymbol{r}} \newcommand{\bs}{\boldsymbol{s}} \newcommand{\bt}{\boldsymbol{t}} \newcommand{\bu}{\boldsymbol{u}} \newcommand{\bv}{\boldsymbol{v}} \newcommand{\bw}{\boldsymbol{w}} \newcommand{\bx}{\boldsymbol{x}} \newcommand{\by}{\boldsymbol{y}} \newcommand{\bz}{\boldsymbol{z}} \newcommand{\bA}{\boldsymbol{A}} \newcommand{\bB}{\boldsymbol{B}} \newcommand{\bC}{\boldsymbol{C}} \newcommand{\bD}{\boldsymbol{D}} \newcommand{\bE}{\boldsymbol{E}} \newcommand{\bF}{\boldsymbol{F}} \newcommand{\bG}{\boldsymbol{G}} \newcommand{\bH}{\boldsymbol{H}} \newcommand{\bI}{\boldsymbol{I}} \newcommand{\bJ}{\boldsymbol{J}} \newcommand{\bK}{\boldsymbol{K}} \newcommand{\bL}{\boldsymbol{L}} \newcommand{\bM}{\boldsymbol{M}} \newcommand{\bN}{\boldsymbol{N}} \newcommand{\bP}{\boldsymbol{P}} \newcommand{\bQ}{\boldsymbol{Q}} \newcommand{\bR}{\boldsymbol{R}} \newcommand{\bS}{\boldsymbol{S}} \newcommand{\bT}{\boldsymbol{T}} \newcommand{\bU}{\boldsymbol{U}} \newcommand{\bV}{\boldsymbol{V}} \newcommand{\bW}{\boldsymbol{W}} \newcommand{\bX}{\boldsymbol{X}} \newcommand{\bY}{\boldsymbol{Y}} \newcommand{\bZ}{\boldsymbol{Z}} % others \newcommand{\false}} \newcommand{\true}} % bold calligraphic \newcommand{\bcalG}{\boldsymbol{\calG}} \newcommand{\calbG}{\bcalG} \newcommand{\bcalX}{\boldsymbol{\calX}} \newcommand{\calbX}{\bcalX} \newcommand{\bcalY}{\boldsymbol{\calY}} \newcommand{\calbY}{\bcalY} \newcommand{\bcalZ}{\boldsymbol{\calZ}} \newcommand{\calbZ}{\bcalZ} % left-right wrappers \DeclarePairedDelimiter\parens{\lparen}{\rparen} \DeclarePairedDelimiter\abs{\lvert}{\rvert} \DeclarePairedDelimiter\norm{\lVert}{\rVert} \DeclarePairedDelimiter\floor{\lfloor}{\rfloor} \DeclarePairedDelimiter\ceil{\lceil}{\rceil} \DeclarePairedDelimiter\braces{\lbrace}{\rbrace} \DeclarePairedDelimiter\bracks{\lbrack}{\rbrack} \DeclarePairedDelimiter\angles{\langle}{\rangle} % something for figures \newcommand{\myfig}[4]{\begin{figure}[H] \centering \includegraphics[width=#1\textwidth]{#2} \caption{#3} \label{#4} \end{figure}} \definecolor{codegreen}{rgb}{0,0.6,0} \definecolor{codegray}{rgb}{0.5,0.5,0.5} \definecolor{codepurple}{rgb}{0.58,0,0.82} \definecolor{backcolour}{rgb}{0.95,0.95,0.92} \lstdefinestyle{mystyle}{ backgroundcolor=\color{backcolour}, commentstyle=\color{codegreen}, keywordstyle=\color{magenta}, numberstyle=\tiny\color{codegray}, stringstyle=\color{codepurple}, basicstyle=\ttfamily\footnotesize, breakatwhitespace=false, breaklines=true, captionpos=b, keepspaces=true, numbers=left, numbersep=5pt, showspaces=false, showstringspaces=false, showtabs=false, tabsize=2 } \lstset{style=mystyle} $$ </div> <div class="post"> <header class="post-header"> <h1 class="post-title">A Concise Proof of the Central Limit Theorem, and Its Actually Useful Version, the Berry-Esseen Theorem</h1> <p class="post-meta">December 28, 2022• fanpu</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/math"> <i class="fas fa-hashtag fa-sm"></i> math</a>   <a href="/blog/tag/machine-learning"> <i class="fas fa-hashtag fa-sm"></i> machine-learning</a>   </p> </header> <figure> <picture> <img src="/assets/img/posts/maine.JPG" class="preview z-depth-1 rounded center" width="100%" height="450px" alt="post.cover" style="object-fit: cover" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Acadia National Park, Maine, USA </div> <article class="post-content"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h3"><a href="#the-central-limit-theorem">The Central Limit Theorem</a></li> <li class="toc-entry toc-h3"> <a href="#proof-of-the-central-limit-theorem">Proof of the Central Limit Theorem</a> <ul> <li class="toc-entry toc-h4"><a href="#moment-generating-functions">Moment Generating Functions</a></li> <li class="toc-entry toc-h4"><a href="#normal-distribution-is-determined-by-its-moments">Normal Distribution is Determined by its Moments</a></li> <li class="toc-entry toc-h4"><a href="#method-of-moments">Method of Moments</a></li> </ul> </li> <li class="toc-entry toc-h3"><a href="#moment-generating-function-of-z">Moment Generating Function of \(Z\)</a></li> <li class="toc-entry toc-h3"><a href="#moment-generating-function-of-z_n">Moment Generating Function of \(Z_n\)</a></li> <li class="toc-entry toc-h3"><a href="#an-uncomfortable-feeling">An Uncomfortable Feeling</a></li> <li class="toc-entry toc-h3"><a href="#the-useful-form-of-the-central-limit-theorem-the-berry-esseen-theorem">The Useful Form of the Central Limit Theorem: The Berry-Esseen Theorem</a></li> <li class="toc-entry toc-h3"><a href="#references">References</a></li> </ul> <p>The Central Limit Theorem is widely used in statistics and machine learning, as it allows us to assume that given enough samples, the mean of the samples will follow a normal distribution. This holds even if the samples come from a distribution that is not normally distributed. In this post, we prove the Central Limit Theorem, and then take a look at the Berry-Esseen Theorem, which actually provides a quantitative bound on the convergence of the distribution and can therefore be actually used in deriving theoretical bounds.</p> <h3 id="the-central-limit-theorem"> <a class="anchor" href="#the-central-limit-theorem" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Central Limit Theorem</h3> <p>The Central Limit states that the mean of an appropriately transformed random variable converges in distribution to a standard normal. We first need to introduce the definition of convergence of probability distributions:</p> <div class="definition"> <div class="theorem-title">Definition (Convergence in Distribution) </div> <div class="theorem-contents"> Let \( F_{X_n} \) and \( F_{X} \) denotes the cumulative density functions (CDF) of \( X_n \) and \( X \) respectively. A sequence \( X_n \) converges to \( X \) in distribution if $$ \lim_{n \to \infty } F_{X_n}(t) = F_X (t)$$ for all points \( t \) where \( F_X \) is continuous. </div> </div> <p>Note that the requirement that it only holds for points of continuity is not superfluous, as there can be distributions that converge but disagree in value at points of discontinuities (i.e take \(X_n = N(0, 1/n)\) and \(X\) to be the point mass at 0, they converge but their CDF take different values at \(t=0\)).</p> <p>The Central Limit Theorem can then be stated in the following form (there are many other equivalent statements):</p> <div class="theorem"> <div class="theorem-title">Theorem (Central Limit Theorem) </div> <div class="theorem-contents"> Let \( X_1, X_2, \dots, X_n \) be a sequence of independent random variables with mean \( \mu \) and variance \( \sigma^2 \). Assume that the moment generating function \( \E \left[ \exp(t X_i) \right] \) is finite for \( t \) in a neighborhood around zero. Let \( \overline{X}_n = \frac{1}{n} \sum\limits_{i=1}^n X_i \). Let $$ Z_n = \frac{\sqrt{n} \left( \overline{X}_n - \mu \right)}{\sigma}. $$ Then \( Z_n \) converges in distribution to \( Z \sim N(0, 1) \). </div> </div> <h3 id="proof-of-the-central-limit-theorem"> <a class="anchor" href="#proof-of-the-central-limit-theorem" aria-hidden="true"><span class="octicon octicon-link"></span></a>Proof of the Central Limit Theorem</h3> <p>There are several ways of proving the Central Limit Theorem. The proof that we will explore today relies on the methods of moments. An alternative measure-theoretic version of the proof relies on Lévy’s Continuity Theorem, and makes use of convolutions and Fourier transforms.</p> <p>Our goal is to show that \(Z_n\) converges in distribution to \(Z \sim N(0, 1)\). To do so, we will show that all the moments of \(Z_n\) converges to the respective moments of \(Z\).</p> <h4 id="moment-generating-functions"> <a class="anchor" href="#moment-generating-functions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Moment Generating Functions</h4> <p>The moments of a random variable can be obtained from its moment-generating function (MGF), defined as follows:</p> <div class="definition"> <div class="theorem-title">Definition (Moment Generating Function) </div> <div class="theorem-contents"> The moment generating function of a random variable \( X \) is given by $$ M_X(t) = \E \left[ e^{tX} \right].$$ </div> </div> <p>It is called a moment generating function since the \(k\)th moment of \(X\), i.e \(\E \left[X^k \right]\), can be obtained by taking the \(k\)th derivative of its moment-generating function (MGF) at 0:</p> \[\E \left[X^k \right] = M^{(k)}(0).\] <p>This is not too hard to see by induction on the fact that \(M_X^k(t) = \E \left[ X^k e^{tX} \right]\). The base case is trivial. For the inductive case,</p> \[\begin{align*} M_X^{(k)}(t) &amp; = \frac{d^k}{dt^k} \E \left[ e^{tX} \right] \\ &amp; = \frac{d}{dt} \E \left[ X^{k-1} e^{tX} \right] &amp; \text{(by IH)}\\ &amp; = \frac{d}{dt} \int f(x) x^{k-1} e^{tx} \; dx \\ &amp; = \int \frac{d}{dt} f(x) x^{k-1} e^{tx} \; dx \\ &amp; = \int f(x) x^{k} e^{tx} \; dx \\ &amp; = \E \left[ X^{k} e^{tX} \right]. \end{align*}\] <p>Substituting \(t=0\) gives us the desired result.</p> <h4 id="normal-distribution-is-determined-by-its-moments"> <a class="anchor" href="#normal-distribution-is-determined-by-its-moments" aria-hidden="true"><span class="octicon octicon-link"></span></a>Normal Distribution is Determined by its Moments</h4> <p>Distributions are determined uniquely by its moments under certain conditions. This is made precise in the following theorem:</p> <div class="theorem"> <div class="theorem-title">Theorem (Sufficient Condition for Distribution to be Determined by Moments) </div> <div class="theorem-contents"> Let \( s_0 &gt; 0 \), and let \( X \) be a random variable with moment generating function \( M_X(s) \) which is finite for \( |s| &lt; s_0 \). Then \( f_X \) is determined by its moments (and also by \( M_X(s)\)). </div> </div> <p>In words, it means that for some open interval around 0 we have that all moments are finite, then the moments determine the distribution. This is true for the normal distribution, where it can be shown that the following recurrence holds for the \(k\)th moment:</p> \[M^k(t) = \mu M^{k-1}(t) + (k-1) \sigma^2 M^{k-2}(t).\] <p>This is also not hard to show by induction, and the proof is omitted for brevity. Since the first two moments of the standard normal distribution are 1 and 0 respectively which are both finite, and our mean and standard deviation are both finite, then all our moments generated by the recurrence must also be finite. So our standard normal is determined by its moments.</p> <h4 id="method-of-moments"> <a class="anchor" href="#method-of-moments" aria-hidden="true"><span class="octicon octicon-link"></span></a>Method of Moments</h4> <p>Now cue the theorem that ties things together:</p> <div class="theorem"> <div class="theorem-title">Theorem (Method of Moments) </div> <div class="theorem-contents"> Suppose that \( X \) is determined by its moments. Let \( X_n \) be a sequence of distributions, such that \( \int f_{X_n}(x) x^k \; dx \) is finite for all \( n, k \in \N \), and such that \( \lim_{n \to \infty} \int f_{X_n}(x) x^k \; dx = \int f_{X}(x) x^k \; dx \) for each \( k \in \N \). Then \( X_n \) converges in distribution to \( X \). </div> </div> <p>In words, it states that if the \(k\)th moment of \(X_n\) is finite and converges to the \(k\)th moment of \(X\) in the limit of \(n\), then \(X_n\) converges to \(X\).</p> <p>This is great, since now we just have to show that all the moments of \(Z_n = \frac{\sqrt{n} \left( \overline{X}_n - \mu \right)}{\sigma}\) converges to the moments of the standard normal \(Z\).</p> <h3 id="moment-generating-function-of-z"> <a class="anchor" href="#moment-generating-function-of-z" aria-hidden="true"><span class="octicon octicon-link"></span></a>Moment Generating Function of \(Z\)</h3> <p>Let’s first find the moment generating function of \(Z\):</p> \[\begin{align*} M_{Z} &amp; = \E \left[ e^{tZ} \right] \\ &amp; = \int f_Z(x) e^{tx} \; dx \\ &amp; = \int \frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2}x^2} e^{tx} \; dx &amp; \text{(subst. pdf of standard Gaussian)} \\ &amp; = \int \frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2}x^2 + tx} \; dx \\ &amp; = \int \frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2}(x - t)^2 + \frac{1}{2}t^2} \; dx &amp; \text{(completing the square)} \\ &amp; = e^{\frac{1}{2}t^2} \int \frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2}(x - t)^2 } \; dx &amp; \text{($e^{\frac{1}{2}t^2}$ does not depend on $x$)} \\ &amp; = e^{\frac{1}{2}t^2} \cdot 1 \\ &amp; = e^{\frac{1}{2}t^2}, \end{align*}\] <p>where the second last step comes from the fact that \(\frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2}(x - t)^2 }\) is a probability distribution of a Gaussian with mean \(t\) and variance 1, and therefore the integral integrates to 1.</p> <h3 id="moment-generating-function-of-z_n"> <a class="anchor" href="#moment-generating-function-of-z_n" aria-hidden="true"><span class="octicon octicon-link"></span></a>Moment Generating Function of \(Z_n\)</h3> <p>Now we find the moment generating function of \(Z_n\). To simplify notation, define \(A_i = \frac{X_i - \mu}{\sigma}\), and see that we can write \(Z_n = \frac{1}{\sqrt{n}} \sum\limits_{i=1}^n A_i\), since</p> \[\begin{align*} \frac{1}{\sqrt{n}} \sum\limits_{i=1}^n A_i &amp;= \frac{1}{\sqrt{n}} \sum\limits_{i=1}^n \frac{X_i - \mu}{\sigma} \\ &amp;= \sqrt{n} \sum\limits_{i=1}^n \frac{X_i - \mu}{ n \sigma} \\ &amp;= \sqrt{n} \frac{\overline{X}_n - \mu}{ \sigma} \\ &amp;= Z_n. \end{align*}\] <p>See that \(\E[A_i] = 0\), and \(\Var(A_i) = 1\).</p> <p>Then starting from the definition of the moment generating function of \(Z_n\),</p> \[\begin{align*} M_{Z_n}(t) &amp; = \E \left[ e^{t Z_n} \right] \\ &amp; = \E \left[ \exp\left(t \frac{1}{\sqrt{n}} \sum\limits_{i=1}^n A_i \right) \right] &amp; \text{(by equivalent definition of $Z_n$)} \\ &amp; = \prod_{i=1}^n \E \left[ \exp\left( \frac{t}{\sqrt{n}} A_i \right) \right] &amp; \text{(by independence of $A_i$'s)} \\ &amp; = \prod_{i=1}^n M_{A_i}(t/\sqrt{n}) &amp; \text{(definition of $M_{A_i}$)} \\ &amp; = M_{A_i}(t/\sqrt{n} )^n. \end{align*}\] <p>Let’s analyze each individual term \(M_{A_i}(t / \sqrt{n})\) by performing a Taylor expansion around 0. Recall that the Taylor expansion of a function \(f(x)\) about a point \(a\) is given by \(f(x)= \sum\limits_{n=0}^\infty \frac{f^{(n)(a)}}{n!}(x-a)^n.\). We will expand up to the second order term, which requires us to find the first three moments of the MGF.</p> <p>These are:</p> \[\begin{align*} M_{A_i}(0) &amp; = \E \left[ e^{t A_i} \right] \Big|_{t=0} \\ &amp; = \E \left[ 1 \right] \\ &amp; = 1, \\ M_{A_i}^\prime(0) &amp; = \E \left[ A_i \right] &amp; \text{(by the $k$th moment property proved previously)} \\ &amp; = 0, \\ M_{A_i}^{\prime \prime}(0) &amp; = \E \left[ A_i^2 \right] &amp; \text{(by the $k$th moment property proved previously)} \\ &amp; = \E \left[ A_i^2 \right] - \E \left[ A_i \right]^2 + \E \left[ A_i \right]^2 \\ &amp; = \Var(A_i) + \E \left[ A_i \right]^2 &amp; \text{($\Var(A_i) = \E \left[ A_i^2 \right] - \E \left[ A_i \right]^2 $)} \\ &amp; = 1 + 0 \\ &amp; = 1. \end{align*}\] <p>Taking all terms up to the second order Taylor expansion allows us to approximate \(M_{A_i}\) as</p> \[\begin{align*} M_{A_i}(t/\sqrt{n}) &amp; \approx M_{A_i}(0) + M_{A_i}^\prime(0) + M_{A_i}^{\prime \prime}(0) \frac{t^2}{2n} \\ &amp; = 1 + 0 + \frac{t^2}{2n} \\ &amp; = 1 + \frac{t^2}{2n}. \end{align*}\] <p>Then now we can write the limit of the MGF of \(Z_n\) as the following:</p> \[\begin{align*} M_{Z_n}(t) &amp; = M_{A_i}(t/\sqrt{n})^n \\ &amp; \approx \left( 1 + \frac{t^2}{2n} \right)^n \\ &amp; \to e^{t^2/2}, &amp; \text{(by identity $\lim_{n \to \infty} (1 + x/n)^n \to e^x$)} \end{align*}\] <p>which shows that it converges to the MGF of \(Z\), as desired. Hooray!</p> <h3 id="an-uncomfortable-feeling"> <a class="anchor" href="#an-uncomfortable-feeling" aria-hidden="true"><span class="octicon octicon-link"></span></a>An Uncomfortable Feeling</h3> <p>However, there is one thing in this proof that might have bothered you. Our result came from making use of the Taylor approximation and taking limits, but there is no bound on how large \(n\) must be for the distributions to converge up to a maximum amount of error. This makes it unsuitable for much theoretical analysis, since usually we would like to know that \(n\) does not have to be too large for us to obtain a sufficiently good approximation to the standard normal.</p> <h3 id="the-useful-form-of-the-central-limit-theorem-the-berry-esseen-theorem"> <a class="anchor" href="#the-useful-form-of-the-central-limit-theorem-the-berry-esseen-theorem" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Useful Form of the Central Limit Theorem: The Berry-Esseen Theorem</h3> <p>The Berry-Esseen theorem solves this limitation by also providing explicit error bounds. This was proved independently by Andrew Berry and Carl-Gustav Esseen in the 40s, and the statement goes as follows:</p> <div class="theorem"> <div class="theorem-title">Theorem (Berry-Esseen) </div> <div class="theorem-contents"> Let \( X_1, \dots, X_n \) be independent random variables. Assume \( \E [X_i] = 0 \; \forall i \). Write \( \sigma_i^2 = \Var [ X_i] = \E[X_i^2] - \E[X_i]^2 = \E[X_i^2] \). Assume \( \sum\limits_{i=1}^n \sigma_i^2 = 1 \). Let \( S = \sum\limits_{i=1}^n X_i \). Then \( \forall u \in \R \), $$ \lvert \Pr \left[ S \leq u \right] - \Pr \left[ Z \leq u \right] \rvert \leq \mbox{const} \cdot \beta, $$ where the exact constant depends on the proof, with the best known constant being \(.5600\) proven by Shevtsova in 2010, and \(\beta = \sum\limits_{i=1}^n \E \left[ \lvert X_i \rvert^3 \right]\). </div> </div> <p>In words, the theorem says that the difference between the CDF of the sum of the mean-0 random variables and the CDF of the standard normal is bounded by a value proportionate to the third moment. This then becomes useful as a tool in proving high probability statements if we can show that the third moment is inversely polynomially small, i.e \(\beta = 1/\poly(n)\).</p> <p>Another thing to note is that the theorem only provides an absolute bound for all values of \(u\). Therefore, when \(u\) is very negative and \(\Pr [Z \leq u ] = \Phi(u)\) is very small, the relative error is actually very large, and therefore is not as helpful.</p> <p>I hope this article has been helpful!</p> <p><em>I would like to express my thanks to my friend <a href="https://adbforlife.github.io/" rel="external nofollow noopener" target="_blank">Albert Gao</a> for reviewing this article and for providing valuable suggestions</em>.</p> <h3 id="references"> <a class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>References</h3> <ul> <li>Rosenthal, J. S. (2016). A first look at rigorous probability theory. World Scientific.</li> <li>Larry Wasserman, CMU 36-705 Intermediate Statistics Lecture Notes. URL: <a href="https://www.stat.cmu.edu/~larry/=stat705/" rel="external nofollow noopener" target="_blank">https://www.stat.cmu.edu/~larry/=stat705/</a> </li> <li>Ryan O’Donnell, CMU 15-751 A Theorist’s Toolkit. URL: <a href="https://www.youtube.com/watch?v=Ig5TuZauhW4" rel="external nofollow noopener" target="_blank">https://www.youtube.com/watch?v=Ig5TuZauhW4</a> </li> </ul> </article><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"fanpu/website","data-repo-id":"R_kgDOIpOodA","data-category":"General","data-category-id":"DIC_kwDOIpOodM4CTKDC","data-mapping":"title","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"top","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Fan Pu Zeng. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script type="text/javascript">$(function(){$('[data-toggle="tooltip"]').tooltip()});</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={loader:{load:["[tex]/mathtools"]},tex:{packages:{"[+]":["mathtools","ams"]}},options:{renderActions:{addMenu:[]}}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-S3VHEYH05S"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-S3VHEYH05S");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script> <script>anchors.add("h1, h2, h3");</script> </body> </html>